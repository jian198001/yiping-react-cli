"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[428],{60419:function($e,pe,t){t.r(pe),t.d(pe,{default:function(){return vr}});var he=t(15009),I=t.n(he),ge=t(99289),g=t.n(ge),ye=t(5574),L=t.n(ye),$=t(97857),te=t.n($),ae=t(37476),ie=t(26855),ue=t(30077),m=t(2453),b=t(28248),re=t(14726),S=t(6493),p=t(67294),_e=[{valueType:"group",columns:[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},width:"m"}]}],V=t(12578);function me(e,d,o){return Ie.apply(this,arguments)}function Ie(){return Ie=g()(I()().mark(function e(d,o,T){var i;return I()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return i="/staff/web/userCenter/purchase/material/page.json",x.abrupt("return",V.request===null||V.request===void 0?void 0:(0,V.request)(i,{method:"GET",params:{params:d,sort:o,filter:T}}));case 2:case"end":return x.stop()}},e)})),Ie.apply(this,arguments)}function we(e){return Oe.apply(this,arguments)}function Oe(){return Oe=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o="/staff/web/userCenter/purchase/material/update.json",i.abrupt("return",request==null?void 0:request(o,{method:"POST",data:d}));case 2:case"end":return i.stop()}},e)})),Oe.apply(this,arguments)}function Ee(e){return Re.apply(this,arguments)}function Re(){return Re=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o="/staff/web/userCenter/purchase/material/getById.json",i.abrupt("return",request==null?void 0:request(o,{method:"GET",params:{id:d}}));case 2:case"end":return i.stop()}},e)})),Re.apply(this,arguments)}function Ce(e){return be.apply(this,arguments)}function be(){return be=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o="/staff/web/userCenter/purchase/material/del.json",i.abrupt("return",request==null?void 0:request(o,{method:"POST",data:_objectSpread({},d)}));case 2:case"end":return i.stop()}},e)})),be.apply(this,arguments)}function Ze(e,d,o,T){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function e(d,o,T,i){var C;return _regeneratorRuntime().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return C="/staff/web/userCenter/purchase/materialItem/page.json?orderId="+d,q.abrupt("return",request==null?void 0:request(C,{method:"GET",params:{params:o,sort:T,filter:i}}));case 2:case"end":return q.stop()}},e)})),P.apply(this,arguments)}function D(e){return E.apply(this,arguments)}function E(){return E=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o="/staff/web/userCenter/purchase/material/updateItem.json",i.abrupt("return",request==null?void 0:request(o,{method:"POST",data:d}));case 2:case"end":return i.stop()}},e)})),E.apply(this,arguments)}function H(e){return f.apply(this,arguments)}function f(){return f=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o="/staff/web/userCenter/purchase/material/submit.json?id="+d,i.abrupt("return",request==null?void 0:request(o,{method:"POST"}));case 2:case"end":return i.stop()}},e)})),f.apply(this,arguments)}function Se(e){return se.apply(this,arguments)}function se(){return se=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o="/staff/web/userCenter/inventory/inbill/purchaseInstock.json",i.abrupt("return",request==null?void 0:request(o,{method:"POST",data:d}));case 2:case"end":return i.stop()}},e)})),se.apply(this,arguments)}var n=t(85893),Ke=function(e){var d,o=(0,p.useState)({}),T=L()(o,2),i=T[0],C=T[1],x=(d=p.useRef)===null||d===void 0?void 0:d(),q=function(){var s=g()(I()().mark(function R(){var v,B,y,z,ne,oe;return I()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,me==null?void 0:me({},{},{});case 2:if(v=W.sent,console.log(v==null?void 0:v.data),C==null||C(v==null?void 0:v.data),!k){W.next=12;break}return W.next=8,S.FO===null||S.FO===void 0?void 0:(0,S.FO)(k);case 8:if(z=W.sent,!(z!=null&&z.data)){W.next=11;break}return W.abrupt("return",x==null||(ne=x.current)===null||ne===void 0||(oe=ne.setFieldsValue)===null||oe===void 0?void 0:oe.call(ne,te()({},z==null?void 0:z.data)));case 11:return W.abrupt("return",x==null||(B=x.current)===null||B===void 0||(y=B.setFieldsValue)===null||y===void 0?void 0:y.call(B,{id:k,orderId:Y}));case 12:case"end":return W.stop()}},R)}));return function(){return s.apply(this,arguments)}}(),U={id:"",title:"",orderId:""},k=e.id,le=e.trigger,X=e.onOk,Y=e.orderId,F=V.useRequest===null||V.useRequest===void 0?void 0:(0,V.useRequest)(S.$G,{manual:!0,onSuccess:function(){var R;m.ZP===null||m.ZP===void 0||(R=m.ZP.success)===null||R===void 0||R.call(m.ZP,"\u63D0\u4EA4\u6210\u529F"),X==null||X()},onError:function(){var R;m.ZP===null||m.ZP===void 0||(R=m.ZP.error)===null||R===void 0||R.call(m.ZP,"\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),J=F.run,ee=F.loading,w=function(){var s=g()(I()().mark(function R(v){return I()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return v=te()(te()({},v),{},{id:k,orderId:Y}),J==null||J(v),y.abrupt("return",!0);case 3:case"end":return y.stop()}},R)}));return function(v){return s.apply(this,arguments)}}(),K={input:{text:"\u521B\u5EFA\u65B0\u7269\u6599"},radio:{text:"\u4ECE\u5DF2\u6709\u7269\u6599\u4E2D\u9009\u62E9"}},O=[{valueType:"group",columns:[{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0},{title:"\u91C7\u8D2D\u65B9\u5F0F",dataIndex:"type",sorter:!0,valueType:"select",valueEnum:K,formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u91C7\u8D2D\u65B9\u5F0F"}]},width:"m",hideInSearch:!0},{valueType:"dependency",name:["type"],columns:function(R){var v=R.type;return v==="input"?[{valueType:"group",columns:[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"name",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0},{title:"\u89C4 \u683C",dataIndex:"sku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m",hideInSearch:!0}]}]:v==="radio"?[{title:"\u7269\u6599\u540D\u79F0\u53CA\u89C4\u683C",dataIndex:"materialId",sorter:!0,valueType:"select",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7269\u6599\u540D\u79F0\u53CA\u89C4\u683C"}]},width:"m",hideInSearch:!0,valueEnum:i}]:[]}}]}];return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ae.Y,{formRef:x,onFinish:w,modalProps:{destroyOnClose:!0,okButtonProps:{loading:ee}},onOpenChange:q,initialValues:U,title:"\u7F16\u8F91\u91C7\u8D2D\u660E\u7EC6\u5355",trigger:le,children:(0,n.jsx)(ie.Z,{layoutType:"Embed",columns:O})})})},ve=t(19515),Te=function(e){var d,o,T,i=(d=p.useRef)===null||d===void 0?void 0:d(),C=(0,p.useState)(!1),x=L()(C,2),q=x[0],U=x[1],k=(o=p.useRef)===null||o===void 0?void 0:o(),le=p.useState===null||p.useState===void 0?void 0:(0,p.useState)([]),X=L()(le,2),Y=X[0],F=X[1],J=m.ZP===null||m.ZP===void 0||(T=m.ZP.useMessage)===null||T===void 0?void 0:T.call(m.ZP),ee=L()(J,2),w=ee[0],K=ee[1],O=V.useRequest===null||V.useRequest===void 0?void 0:(0,V.useRequest)(S.IV,{manual:!0,onSuccess:function(){var a,r,h;F==null||F([]),k==null||(a=k.current)===null||a===void 0||(r=a.reload)===null||r===void 0||r.call(a),w==null||(h=w.success)===null||h===void 0||h.call(w,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var a;w==null||(a=w.error)===null||a===void 0||a.call(w,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),s=O.run,R=O._,v=function(){var M=g()(I()().mark(function a(){var r,h,Q,u,j,l;return I()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(k==null||(r=k.current)===null||r===void 0||r.reload(),!y){c.next=8;break}return c.next=4,S.FO===null||S.FO===void 0?void 0:(0,S.FO)(y);case 4:if(u=c.sent,!(u!=null&&u.data)){c.next=7;break}return c.abrupt("return",i==null||(j=i.current)===null||j===void 0||(l=j.setFieldsValue)===null||l===void 0?void 0:l.call(j,te()({},u==null?void 0:u.data)));case 7:return c.abrupt("return",i==null||(h=i.current)===null||h===void 0||(Q=h.setFieldsValue)===null||Q===void 0?void 0:Q.call(h,{id:y,title:"\u91C7\u8D2D\u5355"+y}));case 8:case"end":return c.stop()}},a)}));return function(){return M.apply(this,arguments)}}(),B={id:"",title:""},y=e.id,z=e.trigger,ne=e.onOk,oe=function(){var M=g()(I()().mark(function a(r){var h,Q,u;return I()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return r=te()(te()({},r),{},{id:y}),l.next=3,S.Vx===null||S.Vx===void 0?void 0:(0,S.Vx)(r);case 3:if(Q=l.sent,(Q==null?void 0:Q.code)===0){l.next=8;break}return m.ZP===null||m.ZP===void 0||(u=m.ZP.error)===null||u===void 0||u.call(m.ZP,Q==null?void 0:Q.message),U==null||U(!1),l.abrupt("return",!1);case 8:return m.ZP===null||m.ZP===void 0||(h=m.ZP.success)===null||h===void 0||h.call(m.ZP,"\u63D0\u4EA4\u6210\u529F"),ne==null||ne(),U==null||U(!1),l.abrupt("return",!0);case 12:case"end":return l.stop()}},a)}));return function(r){return M.apply(this,arguments)}}(),fe=(0,p.useCallback)(function(){var M=g()(I()().mark(function a(r){var h;return I()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:b.Z===null||b.Z===void 0||(h=b.Z.confirm)===null||h===void 0||h.call(b.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8FD9"+(r==null?void 0:r.length)+"\u9879\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D",onOk:function(){var l;(l=function(){var _=g()(I()().mark(function c(){var Z;return I()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,s==null?void 0:s(r==null||(Z=r.map)===null||Z===void 0?void 0:Z.call(r,function(ce){return ce==null?void 0:ce.id}));case 2:case"end":return N.stop()}},c)}));return function(){return _.apply(this,arguments)}}())===null||l===void 0||l()}});case 1:case"end":return u.stop()}},a)}));return function(a){return M.apply(this,arguments)}}(),[s]),W=[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m",hideInSearch:!0},{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0}],Pe=function(){var a;k==null||(a=k.current)===null||a===void 0||a.reload()},de=function(){var M=g()(I()().mark(function a(r){var h;return I()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,S.ZI===null||S.ZI===void 0?void 0:(0,S.ZI)(y,r,null,null);case 2:return h=u.sent,u.abrupt("return",h);case 4:case"end":return u.stop()}},a)}));return function(r){return M.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(ae.Y,{formRef:i,onFinish:oe,modalProps:{destroyOnClose:!0,okButtonProps:{loading:q}},onOpenChange:v,initialValues:B,title:"\u7F16\u8F91\u4FE1\u606F",trigger:z,children:[(0,n.jsx)(ie.Z,{layoutType:"Embed",columns:_e}),(0,n.jsx)(ue.Z,{headerTitle:"\u660E\u7EC6\u8868\u683C",rowKey:"id",search:!1,actionRef:k,toolBarRender:function(){return[(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(re.ZP,{danger:!0,disabled:!Y||!Y.length,onClick:function(){fe(Y)},children:"\u5220 \u9664"}),(0,n.jsx)(Ke,{orderId:y,id:function(){return(0,ve.V)()},onOk:Pe,trigger:(0,n.jsx)(re.ZP,{type:"primary",children:" \u65B0\u5EFA\u660E\u7EC6 "})})]})]},columns:W,request:de})]})})},Ge=t(19632),Ue=t.n(Ge),Le=t(4942),We=t(97685),Fe=t(91),xe=t(74165),Ne=t(15861),A=t(1413),He=t(87462),Ye=t(42110),Je=t(32867),ze=function(d,o){return p.createElement(Je.Z,(0,He.Z)({},d,{ref:o,icon:Ye.Z}))},Qe=p.forwardRef(ze),Xe=Qe,er=t(97462),rr=t(952),nr=t(10915),Me=t(48171),tr=t(53914),ke=t(22270),ur=t(23491),ar=t(53025),lr=t(21770),je=t(88306),Ve=t(8880),ir=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],sr=["record","position","creatorButtonText","newRecordType","parentKey","style"],De=p.createContext(void 0);function Ae(e){var d=e.children,o=e.record,T=e.position,i=e.newRecordType,C=e.parentKey,x=(0,p.useContext)(De);return p.cloneElement(d,(0,A.Z)((0,A.Z)({},d.props),{},{onClick:function(){var q=(0,Ne.Z)((0,xe.Z)().mark(function k(le){var X,Y,F,J;return(0,xe.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(X=(Y=d.props).onClick)===null||X===void 0?void 0:X.call(Y,le);case 2:if(J=w.sent,J!==!1){w.next=5;break}return w.abrupt("return");case 5:x==null||(F=x.current)===null||F===void 0||F.addEditRecord(o,{position:T,newRecordType:i,parentKey:C});case 6:case"end":return w.stop()}},k)}));function U(k){return q.apply(this,arguments)}return U}()}))}function Be(e){var d,o,T=(0,nr.YB)(),i=e.onTableChange,C=e.maxLength,x=e.formItemProps,q=e.recordCreatorProps,U=e.rowKey,k=e.controlled,le=e.defaultValue,X=e.onChange,Y=e.editableFormRef,F=(0,Fe.Z)(e,ir),J=(0,p.useRef)(void 0),ee=(0,p.useRef)(),w=(0,p.useRef)();(0,p.useImperativeHandle)(F.actionRef,function(){return ee.current},[ee.current]);var K=(0,lr.Z)(function(){return e.value||le||[]},{value:e.value,onChange:e.onChange}),O=(0,We.Z)(K,2),s=O[0],R=O[1],v=p.useMemo(function(){return typeof U=="function"?U:function(u,j){return u[U]||j}},[U]),B=(0,Me.J)(function(u){if(typeof u=="number"&&!e.name){if(u>=s.length)return u;var j=s&&s[u];return v==null?void 0:v(j,u)}if((typeof u=="string"||u>=s.length)&&e.name){var l=s.findIndex(function(_,c){var Z;return(v==null||(Z=v(_,c))===null||Z===void 0?void 0:Z.toString())===(u==null?void 0:u.toString())});if(l!==-1)return l}return u});(0,p.useImperativeHandle)(Y,function(){var u=function(_){var c,Z;if(_==null)throw new Error("rowIndex is required");var G=B(_),N=[e.name,(c=G==null?void 0:G.toString())!==null&&c!==void 0?c:""].flat(1).filter(Boolean);return(Z=w.current)===null||Z===void 0?void 0:Z.getFieldValue(N)},j=function(){var _,c=[e.name].flat(1).filter(Boolean);if(Array.isArray(c)&&c.length===0){var Z,G=(Z=w.current)===null||Z===void 0?void 0:Z.getFieldsValue();return Array.isArray(G)?G:Object.keys(G).map(function(N){return G[N]})}return(_=w.current)===null||_===void 0?void 0:_.getFieldValue(c)};return(0,A.Z)((0,A.Z)({},w.current),{},{getRowData:u,getRowsData:j,setRowData:function(_,c){var Z,G;if(_==null)throw new Error("rowIndex is required");var N=B(_),ce=[e.name,(Z=N==null?void 0:N.toString())!==null&&Z!==void 0?Z:""].flat(1).filter(Boolean),fr=Object.assign({},(0,A.Z)((0,A.Z)({},u(_)),c||{})),mr=(0,Ve.Z)({},ce,fr);return(G=w.current)===null||G===void 0||G.setFieldsValue(mr),!0}})},[B,e.name,w.current]),(0,p.useEffect)(function(){e.controlled&&(s||[]).forEach(function(u,j){var l;(l=w.current)===null||l===void 0||l.setFieldsValue((0,Le.Z)({},"".concat(v(u,j)),u))},{})},[(0,tr.ZP)(s),e.controlled]),(0,p.useEffect)(function(){if(e.name){var u;w.current=e==null||(u=e.editable)===null||u===void 0?void 0:u.form}},[(d=e.editable)===null||d===void 0?void 0:d.form,e.name]);var y=q||{},z=y.record,ne=y.position,oe=y.creatorButtonText,fe=y.newRecordType,W=y.parentKey,Pe=y.style,de=(0,Fe.Z)(y,sr),M=ne==="top",a=(0,p.useMemo)(function(){return typeof C=="number"&&C<=(s==null?void 0:s.length)?!1:q!==!1&&(0,n.jsx)(Ae,{record:(0,ke.h)(z,s==null?void 0:s.length,s)||{},position:ne,parentKey:(0,ke.h)(W,s==null?void 0:s.length,s),newRecordType:fe,children:(0,n.jsx)(re.ZP,(0,A.Z)((0,A.Z)({type:"dashed",style:(0,A.Z)({display:"block",margin:"10px 0",width:"100%"},Pe),icon:(0,n.jsx)(Xe,{})},de),{},{children:oe||T.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[q,C,s==null?void 0:s.length]),r=(0,p.useMemo)(function(){return a?M?{components:{header:{wrapper:function(j){var l,_=j.className,c=j.children;return(0,n.jsxs)("thead",{className:_,children:[c,(0,n.jsxs)("tr",{style:{position:"relative"},children:[(0,n.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:a}),(0,n.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(l=F.columns)===null||l===void 0?void 0:l.length,children:a})]})]})}}}}:{tableViewRender:function(j,l){var _,c;return(0,n.jsxs)(n.Fragment,{children:[(_=(c=e.tableViewRender)===null||c===void 0?void 0:c.call(e,j,l))!==null&&_!==void 0?_:l,a]})}}:{}},[M,a]),h=(0,A.Z)({},e.editable),Q=(0,Me.J)(function(u,j){var l,_,c;if((l=e.editable)===null||l===void 0||(_=l.onValuesChange)===null||_===void 0||_.call(l,u,j),(c=e.onValuesChange)===null||c===void 0||c.call(e,j,u),e.controlled){var Z;e==null||(Z=e.onChange)===null||Z===void 0||Z.call(e,j)}});return(e!=null&&e.onValuesChange||(o=e.editable)!==null&&o!==void 0&&o.onValuesChange||e.controlled&&e!==null&&e!==void 0&&e.onChange)&&(h.onValuesChange=Q),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(De.Provider,{value:ee,children:(0,n.jsx)(ue.Z,(0,A.Z)((0,A.Z)((0,A.Z)({search:!1,options:!1,pagination:!1,rowKey:U,revalidateOnFocus:!1},F),r),{},{tableLayout:"fixed",actionRef:ee,onChange:i,editable:(0,A.Z)((0,A.Z)({},h),{},{formProps:(0,A.Z)({formRef:w},h.formProps)}),dataSource:s,onDataSourceChange:function(j){if(R(j),e.name&&ne==="top"){var l,_=(0,Ve.Z)({},[e.name].flat(1).filter(Boolean),j);(l=w.current)===null||l===void 0||l.setFieldsValue(_)}}}))}),e.name?(0,n.jsx)(er.Z,{name:[e.name],children:function(j){var l,_;if(!J.current)return J.current=s,null;var c=(0,je.Z)(j,[e.name].flat(1)),Z=c==null?void 0:c.find(function(G,N){var ce;return!(0,ur.A)(G,(ce=J.current)===null||ce===void 0?void 0:ce[N])});return J.current=s,Z&&(e==null||(l=e.editable)===null||l===void 0||(_=l.onValuesChange)===null||_===void 0||_.call(l,Z,c)),null}}):null]})}function qe(e){var d=rr.ZP.useFormInstance();return e.name?(0,n.jsx)(ar.Z.Item,(0,A.Z)((0,A.Z)({style:{maxWidth:"100%"}},e==null?void 0:e.formItemProps),{},{name:e.name,shouldUpdate:function(T,i){var C=[e.name].flat(1);try{return JSON.stringify((0,je.Z)(T,C))!==JSON.stringify((0,je.Z)(i,C))}catch(x){return!0}},children:(0,n.jsx)(Be,(0,A.Z)((0,A.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e),{},{editable:(0,A.Z)((0,A.Z)({},e.editable),{},{form:d})}))})):(0,n.jsx)(Be,(0,A.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e))}qe.RecordCreator=Ae;var or=qe,dr=function(e){var d,o=(d=p.useRef)===null||d===void 0?void 0:d(),T=function(){var K=g()(I()().mark(function O(){var s,R,v;return I()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!C){y.next=5;break}return y.next=3,S.FO===null||S.FO===void 0?void 0:(0,S.FO)(C);case 3:return v=y.sent,y.abrupt("return",o==null||(s=o.current)===null||s===void 0||(R=s.setFieldsValue)===null||R===void 0?void 0:R.call(s,{id:C,title:"\u91C7\u8D2D\u5165\u5E93\u5355"+(0,ve.V)()}));case 5:case"end":return y.stop()}},O)}));return function(){return K.apply(this,arguments)}}(),i={id:"",title:""},C=e.id,x=e.trigger,q=e.onOk,U=V.useRequest===null||V.useRequest===void 0?void 0:(0,V.useRequest)(S.k9,{manual:!0,onSuccess:function(){var O;m.ZP===null||m.ZP===void 0||(O=m.ZP.success)===null||O===void 0||O.call(m.ZP,"\u63D0\u4EA4\u6210\u529F"),console.log("instock onok"),q==null||q()},onError:function(){var O;m.ZP===null||m.ZP===void 0||(O=m.ZP.error)===null||O===void 0||O.call(m.ZP,"\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),k=U.run,le=U.loading,X=function(){var K=g()(I()().mark(function O(s){return I()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return s=te()(te()({},s),{},{id:C,item:ee}),k==null||k(s),v.abrupt("return",!0);case 3:case"end":return v.stop()}},O)}));return function(s){return K.apply(this,arguments)}}(),Y=function(O){ee=Ue()(O)},F=[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u5931\u6548\u671F",dataIndex:"exp",sorter:!0,valueType:"date",tooltip:"\u65E5\u671F",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5931\u6548\u671F"}]},width:"m",hideInSearch:!0},{title:(0,n.jsx)(V.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(O,s,R,v){return[(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(re.ZP,{type:"primary",onClick:function(){v.startEditable(s.id)},children:"\u7F16 \u8F91"})})]}}],J=[{valueType:"group",columns:[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},width:"m"}]}],ee=[],w=function(){var K=g()(I()().mark(function O(s){var R;return I()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,S.ZI===null||S.ZI===void 0?void 0:(0,S.ZI)(C,s,null,null);case 2:return R=B.sent,B.abrupt("return",R);case 4:case"end":return B.stop()}},O)}));return function(s){return K.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(ae.Y,{formRef:o,onFinish:X,modalProps:{destroyOnClose:!0,okButtonProps:{loading:le}},onOpenChange:T,initialValues:i,title:"\u7269\u6599\u5165\u5E93\u5355",trigger:x,children:[(0,n.jsx)(ie.Z,{formRef:o,layoutType:"Embed",columns:J}),(0,n.jsx)(or,{headerTitle:"\u660E\u7EC6\u8868\u683C",rowKey:"id",search:!1,toolBarRender:function(){return[(0,n.jsx)(n.Fragment,{children:" "})]},columns:F,recordCreatorProps:!1,onChange:Y,editable:{type:"multiple",actionRender:function(O,s,R){return[R.save,R.cancel]}},controlled:!0,request:w})]})})},cr=t(97131),vr=function(){var e,d,o=(0,p.useState)(""),T=L()(o,2),i=T[0],C=T[1],x=(0,p.useState)(""),q=L()(x,2),U=q[0],k=q[1],le=(0,V.useModel)("@@initialState"),X=le.initialState.currentUser,Y=X===void 0?{}:X,F=(e=p.useRef)===null||e===void 0?void 0:e(),J=p.useState===null||p.useState===void 0?void 0:(0,p.useState)([]),ee=L()(J,2),w=ee[0],K=ee[1],O=V.useIntl===null||V.useIntl===void 0?void 0:(0,V.useIntl)(),s=m.ZP===null||m.ZP===void 0||(d=m.ZP.useMessage)===null||d===void 0?void 0:d.call(m.ZP),R=L()(s,2),v=R[0],B=R[1],y=V.useRequest===null||V.useRequest===void 0?void 0:(0,V.useRequest)(S.IV,{manual:!0,onSuccess:function(){var a,r,h;K==null||K([]),F==null||(a=F.current)===null||a===void 0||(r=a.reload)===null||r===void 0||r.call(a),v==null||(h=v.success)===null||h===void 0||h.call(v,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var a;v==null||(a=v.error)===null||a===void 0||a.call(v,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),z=y.run,ne=y.loading,oe=[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,width:"m"},{title:"\u660E\u7EC6\u6570",dataIndex:"itemCount",sorter:!0,hideInForm:!0},{title:"\u72B6 \u6001",dataIndex:"tradeState",sorter:!0,valueType:"select",hideInForm:!0,valueEnum:{edit:{text:"\u5F85\u63D0\u4EA4"},submit:{text:"\u5F85\u5165\u5E93"},stock:{text:"\u5DF2\u91C7\u8D2D\u5B8C\u6210"}}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"create_date",sorter:!0,hideInForm:!0,valueType:"date"},{title:"\u64CD\u4F5C\u8005",dataIndex:"username",sorter:!0,hideInForm:!0},{title:(0,n.jsx)(V.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(a,r){return[(0,n.jsxs)(n.Fragment,{children:[(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(0,n.jsx)(Te,{trigger:(0,n.jsx)(re.ZP,{type:"primary",children:"\u7F16 \u8F91"}),id:r==null?void 0:r.id,onOk:de},r==null?void 0:r.id),(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(r==null?void 0:r.itemCount)>0&&(0,n.jsx)(re.ZP,{type:"primary",onClick:function(){W==null||W(r)},onOk:de,children:"\u63D0 \u4EA4"}),(r==null?void 0:r.tradeState)==="submit"&&(0,n.jsx)(dr,{id:r==null?void 0:r.id,trigger:(0,n.jsx)(re.ZP,{type:"primary",children:"\u5165 \u5E93"}),onOk:de}),(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(0,n.jsx)(re.ZP,{onClick:function(){fe==null||fe(r)},danger:!0,onOk:de,children:"\u5220 \u9664"})]})]}}],fe=(0,p.useCallback)(function(){var M=g()(I()().mark(function a(r){var h;return I()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:b.Z===null||b.Z===void 0||(h=b.Z.confirm)===null||h===void 0||h.call(b.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u6807\u9898\u4E3A".concat(r.title,"\u7684\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D"),onOk:function(){var l;(l=function(){var _=g()(I()().mark(function c(){return I()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,z==null?void 0:z([r==null?void 0:r.id]);case 2:case"end":return G.stop()}},c)}));return function(){return _.apply(this,arguments)}}())===null||l===void 0||l()}});case 1:case"end":return u.stop()}},a)}));return function(a){return M.apply(this,arguments)}}(),[z]),W=(0,p.useCallback)(function(){var M=g()(I()().mark(function a(r){var h;return I()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:b.Z===null||b.Z===void 0||(h=b.Z.confirm)===null||h===void 0||h.call(b.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u63D0\u4EA4\u6807\u9898\u4E3A".concat(r==null?void 0:r.title,"\u7684\u4FE1\u606F?\u63D0\u4EA4\u540E\u5C06\u4E0D\u53EF\u518D\u6B21\u7F16\u8F91"),onOk:function(){var l;(l=function(){var _=g()(I()().mark(function c(){var Z;return I()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,S.Ps===null||S.Ps===void 0?void 0:(0,S.Ps)(r==null?void 0:r.id);case 2:F==null||(Z=F.current)===null||Z===void 0||Z.reload();case 3:case"end":return N.stop()}},c)}));return function(){return _.apply(this,arguments)}}())===null||l===void 0||l()}});case 1:case"end":return u.stop()}},a)}));return function(a){return M.apply(this,arguments)}}(),[z]),Pe=function(){var a;return!!(Y!=null&&(a=Y.roleIds)!==null&&a!==void 0&&a.includes("1"))},de=function(){var a;console.log("onOk"),F==null||(a=F.current)===null||a===void 0||a.reload(),C==null||C(ve.V===null||ve.V===void 0?void 0:(0,ve.V)())};return p.useEffect===null||p.useEffect===void 0||(0,p.useEffect)(function(){C==null||C(ve.V===null||ve.V===void 0?void 0:(0,ve.V)())},[]),(0,n.jsxs)(cr._z,{children:[B,(0,n.jsx)(ue.Z,{headerTitle:O==null?void 0:O.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:F,rowKey:"id",toolBarRender:function(){return[(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(Te,{trigger:(0,n.jsx)(re.ZP,{type:"primary",disabled:!Pe(),children:" \u65B0\u5EFA\u91C7\u8D2D\u5355 "}),id:i,onOk:de})]})]},request:S.Md,columns:oe,rowSelection:{onChange:function(a,r){K(r)}}})]})}},6493:function($e,pe,t){t.d(pe,{$G:function(){return Ie},FO:function(){return m},IV:function(){return re},Md:function(){return te},Ps:function(){return Re},Vx:function(){return ie},ZI:function(){return V},k9:function(){return be}});var he=t(97857),I=t.n(he),ge=t(15009),g=t.n(ge),ye=t(99289),L=t.n(ye),$=t(12578);function te(P,D,E){return ae.apply(this,arguments)}function ae(){return ae=L()(g()().mark(function P(D,E,H){var f;return g()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return f="/staff/web/userCenter/purchaseOrder/purchaseOrder/page.json",se.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(f,{method:"GET",params:{params:D,sort:E,filter:H}}));case 2:case"end":return se.stop()}},P)})),ae.apply(this,arguments)}function ie(P){return ue.apply(this,arguments)}function ue(){return ue=L()(g()().mark(function P(D){var E;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E="/staff/web/userCenter/purchaseOrder/purchaseOrder/update.json",f.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(E,{method:"POST",data:D}));case 2:case"end":return f.stop()}},P)})),ue.apply(this,arguments)}function m(P){return b.apply(this,arguments)}function b(){return b=L()(g()().mark(function P(D){var E;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E="/staff/web/userCenter/purchaseOrder/purchaseOrder/getById.json",f.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(E,{method:"GET",params:{id:D}}));case 2:case"end":return f.stop()}},P)})),b.apply(this,arguments)}function re(P){return S.apply(this,arguments)}function S(){return S=L()(g()().mark(function P(D){var E;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E="/staff/web/userCenter/purchaseOrder/purchaseOrder/del.json",f.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(E,{method:"POST",data:I()({},D)}));case 2:case"end":return f.stop()}},P)})),S.apply(this,arguments)}function p(){return _e.apply(this,arguments)}function _e(){return _e=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var D;return _regeneratorRuntime().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return D="/staff/web/userCenter/purchaseOrder/purchaseOrder/page.json",H.abrupt("return",request==null?void 0:request(D,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return H.stop()}},P)})),_e.apply(this,arguments)}function V(P,D,E,H){return me.apply(this,arguments)}function me(){return me=L()(g()().mark(function P(D,E,H,f){var Se;return g()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Se="/staff/web/userCenter/purchaseOrder/purchaseOrderItem/page.json?orderId="+D,n.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(Se,{method:"GET",params:{params:E,sort:H,filter:f}}));case 2:case"end":return n.stop()}},P)})),me.apply(this,arguments)}function Ie(P){return we.apply(this,arguments)}function we(){return we=L()(g()().mark(function P(D){var E;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E="/staff/web/userCenter/purchaseOrder/purchaseOrder/updateItem.json",f.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(E,{method:"POST",data:D}));case 2:case"end":return f.stop()}},P)})),we.apply(this,arguments)}function Oe(P){return Ee.apply(this,arguments)}function Ee(){return Ee=_asyncToGenerator(_regeneratorRuntime().mark(function P(D){var E;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E="/staff/web/userCenter/purchaseOrder/purchaseOrder/del.json",f.abrupt("return",request==null?void 0:request(E,{method:"POST",data:_objectSpread({},D)}));case 2:case"end":return f.stop()}},P)})),Ee.apply(this,arguments)}function Re(P){return Ce.apply(this,arguments)}function Ce(){return Ce=L()(g()().mark(function P(D){var E;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E="/staff/web/userCenter/purchaseOrder/purchaseOrder/submit.json?id="+D,f.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(E,{method:"POST"}));case 2:case"end":return f.stop()}},P)})),Ce.apply(this,arguments)}function be(P){return Ze.apply(this,arguments)}function Ze(){return Ze=L()(g()().mark(function P(D){var E;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E="/staff/web/userCenter/inventory/inbill/purchaseInstock.json",f.abrupt("return",$.request===null||$.request===void 0?void 0:(0,$.request)(E,{method:"POST",data:D}));case 2:case"end":return f.stop()}},P)})),Ze.apply(this,arguments)}},19515:function($e,pe,t){t.d(pe,{P:function(){return te},V:function(){return $}});var he=t(64599),I=t.n(he),ge=t(19632),g=t.n(ge),ye=t(27484),L=t.n(ye);function $(){var ae=L()().format("YYYYMMDDHHmmssSSS").toString();return ae}function te(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ie=g()(ae),ue=I()(ie),m;try{for(ue.s();!(m=ue.n()).done;){var b=m.value;!(b!=null&&b.valueType)||(b==null?void 0:b.valueType)!=="group"||!(b!=null&&b.columns)||!(b!=null&&b.columns.length)||ie.push.apply(ie,g()(b==null?void 0:b.columns))}}catch(re){ue.e(re)}finally{ue.f()}return ie.filter(function(re){return re.valueType!=="group"})}}}]);
