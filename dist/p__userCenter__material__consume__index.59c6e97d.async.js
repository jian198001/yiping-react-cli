"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[193],{16030:function(Q,w,e){e.r(w),e.d(w,{default:function(){return re}});var $=e(19632),D=e.n($),F=e(5574),j=e.n(F),Z=e(15009),p=e.n(Z),A=e(97857),E=e.n(A),C=e(99289),h=e.n(C),b=e(37476),M=e(26855),r=e(2453),l=e(12578);function Y(u,a,t){return B.apply(this,arguments)}function B(){return B=h()(p()().mark(function u(a,t,s){var n;return p()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n="/staff/web/userCenter/inventory/consume/page.json",i.abrupt("return",l.request===null||l.request===void 0?void 0:(0,l.request)(n,{method:"GET",params:{params:a,sort:t,filter:s}}));case 2:case"end":return i.stop()}},u)})),B.apply(this,arguments)}function te(u){return V.apply(this,arguments)}function V(){return V=_asyncToGenerator(_regeneratorRuntime().mark(function u(a){var t;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t="/staff/web/userCenter/inventory/consume/update.json",n.abrupt("return",request==null?void 0:request(t,{method:"POST",data:a}));case 2:case"end":return n.stop()}},u)})),V.apply(this,arguments)}function x(u){return k.apply(this,arguments)}function k(){return k=h()(p()().mark(function u(a){var t;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t="/staff/web/userCenter/inventory/consume/getById.json",n.abrupt("return",l.request===null||l.request===void 0?void 0:(0,l.request)(t,{method:"GET",params:{id:a}}));case 2:case"end":return n.stop()}},u)})),k.apply(this,arguments)}function ne(u){return G.apply(this,arguments)}function G(){return G=_asyncToGenerator(_regeneratorRuntime().mark(function u(a){var t;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t="/staff/web/userCenter/inventory/consume/del.json",n.abrupt("return",request==null?void 0:request(t,{method:"POST",data:_objectSpread({},a)}));case 2:case"end":return n.stop()}},u)})),G.apply(this,arguments)}function ue(){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime().mark(function u(){var a;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a="/staff/web/userCenter/inventory/consume/page.json",s.abrupt("return",request==null?void 0:request(a,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return s.stop()}},u)})),K.apply(this,arguments)}function ae(u){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function u(a){var t;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t="/staff/web/userCenter/inventory/outbill/consumeOutstock.json",n.abrupt("return",request==null?void 0:request(t,{method:"POST",data:a}));case 2:case"end":return n.stop()}},u)})),U.apply(this,arguments)}var y=e(67294),v=e(85893),N=function(u){var a,t=(a=y.useRef)===null||a===void 0?void 0:a(),s={},n=function(){var O=h()(p()().mark(function R(){var d,T,_,o,f,c;return p()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(d=i==null?void 0:i.id,!d){m.next=9;break}return m.next=4,x==null?void 0:x(d);case 4:if(o=m.sent,!(o!=null&&o.data)){m.next=8;break}return s=E()(E()({},s),o==null?void 0:o.data),m.abrupt("return",t==null||(f=t.current)===null||f===void 0||(c=f.setFieldsValue)===null||c===void 0?void 0:c.call(f,E()({},o==null?void 0:o.data)));case 8:return m.abrupt("return",t==null||(T=t.current)===null||T===void 0||(_=T.setFieldsValue)===null||_===void 0?void 0:_.call(T,{id:d,instockQuantity:1}));case 9:case"end":return m.stop()}},R)}));return function(){return O.apply(this,arguments)}}(),P={id:"",title:""},i=u.record,L=u.trigger,W=u.onOk,H=function(){var O=h()(p()().mark(function R(d){var T,_,o,f,c,g;return p()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(d=E()(E()({},i),d),!(((T=d)===null||T===void 0?void 0:T.instockQuantity)<=0)){S.next=4;break}return r.ZP===null||r.ZP===void 0||(c=r.ZP.error)===null||c===void 0||c.call(r.ZP,"\u9886\u7528\u6570\u91CF\u9700\u5927\u4E8E0, \u8BF7\u91CD\u8BD5!"),S.abrupt("return",!1);case 4:if(!(((_=d)===null||_===void 0?void 0:_.instockQuantity)>((o=s)===null||o===void 0?void 0:o.quantity))){S.next=7;break}return r.ZP===null||r.ZP===void 0||(g=r.ZP.error)===null||g===void 0||g.call(r.ZP,"\u9886\u7528\u6570\u91CF\u9700\u5C0F\u4E8E\u7B49\u4E8E\u5E93\u5B58\u6570\u91CF, \u8BF7\u91CD\u8BD5!"),S.abrupt("return",!1);case 7:return(f=run)===null||f===void 0||f(d),S.abrupt("return",!0);case 9:case"end":return S.stop()}},R)}));return function(d){return O.apply(this,arguments)}}(),q=[{valueType:"group",columns:[{title:"\u5F52\u8FD8\u6570\u91CF",dataIndex:"instockQuantity",valueType:"digit",tooltip:"\u6B63\u6570",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"},{type:"number",min:0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"}]},width:"m"}]}];return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(b.Y,{formRef:t,onFinish:H,modalProps:{destroyOnClose:!0,okButtonProps:{loading}},onOpenChange:n,initialValues:P,title:"\u5F52\u8FD8\u5165\u5E93\u5355",trigger:L,children:(0,v.jsx)(M.Z,{layoutType:"Embed",columns:q})})})},z=e(97131),J=e(30077),X=e(14726),ee=[{valueType:"group",columns:[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m"},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m"}]},{valueType:"group",columns:[{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"}]},width:"m"},{title:"\u9886\u7528\u65F6\u95F4",dataIndex:"createDate",sorter:!0,valueType:"datetime",tooltip:"\u65F6\u95F4",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u65F6\u95F4"}]},width:"m"},{title:"\u5931\u6548\u671F",dataIndex:"exp",sorter:!0,valueType:"date",tooltip:"\u65E5\u671F",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u65E5\u671F"}]},width:"m"}]}],se=[{valueType:"group",columns:[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u9886\u7528\u6570\u91CF",dataIndex:"consumeQuantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",initialValue:1,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"},{type:"number",min:0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"}]},width:"m",hideInSearch:!0}]}],I=e(19515),re=function(){var u,a,t=(0,y.useState)(""),s=j()(t,2),n=s[0],P=s[1],i=(u=y.useRef)===null||u===void 0?void 0:u(),L=y.useState===null||y.useState===void 0?void 0:(0,y.useState)([]),W=j()(L,2),H=W[0],q=W[1],O=l.useIntl===null||l.useIntl===void 0?void 0:(0,l.useIntl)(),R=r.ZP===null||r.ZP===void 0||(a=r.ZP.useMessage)===null||a===void 0?void 0:a.call(r.ZP),d=j()(R,2),T=d[0],_=d[1],o=[].concat(D()(I.P===null||I.P===void 0?void 0:(0,I.P)(ee)),[{title:(0,v.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(g,m){return[(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(N,{record:m,onOk:f,trigger:(0,v.jsx)(X.ZP,{type:"primary",children:"\u5F52\u8FD8\u5165\u5E93"})})})]}}]),f=function(){var g;P==null||P(I.V===null||I.V===void 0?void 0:(0,I.V)()),i==null||(g=i.current)===null||g===void 0||g.reload()};return y.useEffect===null||y.useEffect===void 0||(0,y.useEffect)(function(){P==null||P(I.V===null||I.V===void 0?void 0:(0,I.V)())},[]),(0,v.jsxs)(z._z,{children:[_,(0,v.jsx)(J.Z,{headerTitle:O==null?void 0:O.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:i,rowKey:"id",toolBarRender:function(){return[]},request:Y,columns:o,rowSelection:{onChange:function(g,m){q(m)}}})]})}},19515:function(Q,w,e){e.d(w,{P:function(){return E},V:function(){return A}});var $=e(64599),D=e.n($),F=e(19632),j=e.n(F),Z=e(27484),p=e.n(Z);function A(){var C=p()().format("YYYYMMDDHHmmssSSS").toString();return C}function E(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],h=j()(C),b=D()(h),M;try{for(b.s();!(M=b.n()).done;){var r=M.value;!(r!=null&&r.valueType)||(r==null?void 0:r.valueType)!=="group"||!(r!=null&&r.columns)||!(r!=null&&r.columns.length)||h.push.apply(h,j()(r==null?void 0:r.columns))}}catch(l){b.e(l)}finally{b.f()}return h.filter(function(l){return l.valueType!=="group"})}}}]);
