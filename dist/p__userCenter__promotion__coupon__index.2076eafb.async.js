"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[940],{51565:function(re,I,e){e.r(I),e.d(I,{default:function(){return ie}});var V=e(15009),l=e.n(V),w=e(99289),p=e.n(w),U=e(19632),K=e.n(U),G=e(5574),_=e.n(G),M=e(97857),E=e.n(M),R=e(37476),b=e(26855),u=e(2453),n=e(12578);function ue(t,a,d){return L.apply(this,arguments)}function L(){return L=p()(l()().mark(function t(a,d,v){var r;return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r="/staff/web/userCenter/promotion/coupon/page.json",i.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(r,{method:"GET",params:{params:a,sort:d,filter:v}}));case 2:case"end":return i.stop()}},t)})),L.apply(this,arguments)}function te(t){return W.apply(this,arguments)}function W(){return W=p()(l()().mark(function t(a){var d;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return d="/staff/web/userCenter/promotion/coupon/update.json",r.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(d,{method:"POST",data:a}));case 2:case"end":return r.stop()}},t)})),W.apply(this,arguments)}function ae(t){return x.apply(this,arguments)}function x(){return x=p()(l()().mark(function t(a){var d;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return d="/staff/web/userCenter/promotion/coupon/getById.json",r.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(d,{method:"GET",params:{id:a}}));case 2:case"end":return r.stop()}},t)})),x.apply(this,arguments)}function le(t){return H.apply(this,arguments)}function H(){return H=p()(l()().mark(function t(a){var d;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return d="/staff/web/userCenter/promotion/coupon/del.json",r.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(d,{method:"POST",data:E()({},a)}));case 2:case"end":return r.stop()}},t)})),H.apply(this,arguments)}function pe(){return Y.apply(this,arguments)}function Y(){return Y=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var a;return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return a="/staff/web/userCenter/promotion/coupon/page.json",v.abrupt("return",request==null?void 0:request(a,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return v.stop()}},t)})),Y.apply(this,arguments)}var h=e(67294),X=[{valueType:"group",columns:[{title:"\u540D \u79F0",dataIndex:"name",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]}],f=e(85893),q=function(t){var a=(0,h.useRef)(),d=function(){var j=p()(l()().mark(function S(){var m;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!r){c.next=7;break}return c.next=3,ae(r);case 3:if(m=c.sent,!m.data){c.next=6;break}return c.abrupt("return",a.current.setFieldsValue(E()({},m.data)));case 6:return c.abrupt("return",a.current.setFieldsValue({id:r}));case 7:case"end":return c.stop()}},S)}));return function(){return j.apply(this,arguments)}}(),v={id:"",title:""},r=t.id,O=t.trigger,i=t.onOk,A=(0,n.useRequest)(te,{manual:!0,onSuccess:function(){u.ZP.success("\u63D0\u4EA4\u6210\u529F"),i()},onError:function(){u.ZP.error("\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),Z=A.run,$=A.loading,T=function(){var j=p()(l()().mark(function S(m){return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return m=E()(E()({},m),{},{id:r}),Z(m),c.abrupt("return",!0);case 3:case"end":return c.stop()}},S)}));return function(m){return j.apply(this,arguments)}}();return(0,f.jsx)(R.Y,{formRef:a,onFinish:T,modalProps:{destroyOnClose:!0,okButtonProps:{loading:$}},onOpenChange:d,initialValues:v,title:"\u7F16\u8F91\u4FE1\u606F",trigger:O,children:(0,f.jsx)(b.Z,{layoutType:"Embed",columns:X})})},oe=e(97131),se=e(30077),k=e(14726),F=e(28248),P=e(19515),ie=function(){var t,a,d=(0,h.useState)(""),v=_()(d,2),r=v[0],O=v[1],i=(t=h.useRef)===null||t===void 0?void 0:t(),A=h.useState===null||h.useState===void 0?void 0:(0,h.useState)([]),Z=_()(A,2),$=Z[0],T=Z[1],j=n.useIntl===null||n.useIntl===void 0?void 0:(0,n.useIntl)(),S=u.ZP===null||u.ZP===void 0||(a=u.ZP.useMessage)===null||a===void 0?void 0:a.call(u.ZP),m=_()(S,2),y=m[0],c=m[1],ee=n.useRequest===null||n.useRequest===void 0?void 0:(0,n.useRequest)(le,{manual:!0,onSuccess:function(){var o,s,g;T==null||T([]),i==null||(o=i.current)===null||o===void 0||(s=o.reload)===null||s===void 0||s.call(o),y==null||(g=y.success)===null||g===void 0||g.call(y,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var o;y==null||(o=y.error)===null||o===void 0||o.call(y,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),D=ee.run,me=ee.loading,de=[].concat(K()(P.P===null||P.P===void 0?void 0:(0,P.P)(X)),[{title:(0,f.jsx)(n.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(o,s){var g;return[(0,f.jsx)(q,{trigger:(0,f.jsx)(k.ZP,{children:"\u7F16 \u8F91"}),id:s==null?void 0:s.id,onOk:i==null||(g=i.current)===null||g===void 0?void 0:g.reload},s.id)]}}]),ce=(0,h.useCallback)(function(){var C=p()(l()().mark(function o(s){var g;return l()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:F.Z===null||F.Z===void 0||(g=F.Z.confirm)===null||g===void 0||g.call(F.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8FD9"+(s==null?void 0:s.length)+"\u9879\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D",onOk:function(){var N;(N=function(){var fe=p()(l()().mark(function ne(){var J;return l()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,D==null?void 0:D(s==null||(J=s.map)===null||J===void 0?void 0:J.call(s,function(Q){return Q==null?void 0:Q.id}));case 2:case"end":return B.stop()}},ne)}));return function(){return fe.apply(this,arguments)}}())===null||N===void 0||N()}});case 1:case"end":return z.stop()}},o)}));return function(o){return C.apply(this,arguments)}}(),[D]),ve=function(){var o;O==null||O(P.V===null||P.V===void 0?void 0:(0,P.V)()),i==null||(o=i.current)===null||o===void 0||o.reload()};return h.useEffect===null||h.useEffect===void 0||(0,h.useEffect)(function(){O==null||O(P.V===null||P.V===void 0?void 0:(0,P.V)())},[]),(0,f.jsxs)(oe._z,{children:[c,(0,f.jsx)(se.Z,{headerTitle:j==null?void 0:j.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:i,rowKey:"id",toolBarRender:function(){return[(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(k.ZP,{danger:!0,disabled:!$||!$.length,onClick:function(){ce($)},children:"\u5220 \u9664"}),(0,f.jsx)(q,{trigger:(0,f.jsx)(k.ZP,{type:"primary",children:" \u65B0 \u5EFA "}),id:r,onOk:ve})]})]},request:ue,columns:de,rowSelection:{onChange:function(o,s){T(s)}}})]})}},19515:function(re,I,e){e.d(I,{P:function(){return _},V:function(){return G}});var V=e(64599),l=e.n(V),w=e(19632),p=e.n(w),U=e(27484),K=e.n(U);function G(){var M=K()().format("YYYYMMDDHHmmssSSS").toString();return M}function _(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=p()(M),R=l()(E),b;try{for(R.s();!(b=R.n()).done;){var u=b.value;!(u!=null&&u.valueType)||(u==null?void 0:u.valueType)!=="group"||!(u!=null&&u.columns)||!(u!=null&&u.columns.length)||E.push.apply(E,p()(u==null?void 0:u.columns))}}catch(n){R.e(n)}finally{R.f()}return E.filter(function(n){return n.valueType!=="group"})}}}]);
