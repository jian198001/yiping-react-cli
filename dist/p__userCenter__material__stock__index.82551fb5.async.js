"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[210],{14861:function(Y,M,e){e.r(M),e.d(M,{default:function(){return ee}});var w=e(19632),A=e.n(w),F=e(5574),S=e.n(F),Z=e(15009),f=e.n(Z),D=e(97857),R=e.n(D),b=e(99289),h=e.n(b),C=e(37476),$=e(26855),r=e(2453),o=e(12578);function Q(n,u,t){return B.apply(this,arguments)}function B(){return B=h()(f()().mark(function n(u,t,s){var a;return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a="/staff/web/userCenter/purchase/stock/page.json",i.abrupt("return",o.request===null||o.request===void 0?void 0:(0,o.request)(a,{method:"GET",params:{params:u,sort:t,filter:s}}));case 2:case"end":return i.stop()}},n)})),B.apply(this,arguments)}function re(n){return V.apply(this,arguments)}function V(){return V=_asyncToGenerator(_regeneratorRuntime().mark(function n(u){var t;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t="/staff/web/userCenter/purchase/stock/update.json",a.abrupt("return",request==null?void 0:request(t,{method:"POST",data:u}));case 2:case"end":return a.stop()}},n)})),V.apply(this,arguments)}function G(n){return x.apply(this,arguments)}function x(){return x=h()(f()().mark(function n(u){var t;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t="/staff/web/userCenter/purchase/stock/getById.json",a.abrupt("return",o.request===null||o.request===void 0?void 0:(0,o.request)(t,{method:"GET",params:{id:u}}));case 2:case"end":return a.stop()}},n)})),x.apply(this,arguments)}function te(n){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime().mark(function n(u){var t;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t="/staff/web/userCenter/purchase/stock/del.json",a.abrupt("return",request==null?void 0:request(t,{method:"POST",data:_objectSpread({},u)}));case 2:case"end":return a.stop()}},n)})),K.apply(this,arguments)}function ne(){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function n(){var u;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u="/staff/web/userCenter/purchase/stock/page.json",s.abrupt("return",request==null?void 0:request(u,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return s.stop()}},n)})),U.apply(this,arguments)}var y=e(67294),m=e(85893),z=function(n){var u,t=(u=y.useRef)===null||u===void 0?void 0:u(),s={},a=function(){var j=h()(f()().mark(function O(){var d,_,E,l,p,c;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(d=i==null?void 0:i.id,!d){v.next=9;break}return v.next=4,G==null?void 0:G(d);case 4:if(l=v.sent,!(l!=null&&l.data)){v.next=8;break}return s=R()(R()({},s),l==null?void 0:l.data),v.abrupt("return",t==null||(p=t.current)===null||p===void 0||(c=p.setFieldsValue)===null||c===void 0?void 0:c.call(p,R()({},l==null?void 0:l.data)));case 8:return v.abrupt("return",t==null||(_=t.current)===null||_===void 0||(E=_.setFieldsValue)===null||E===void 0?void 0:E.call(_,{id:d,consumeQuantity:1}));case 9:case"end":return v.stop()}},O)}));return function(){return j.apply(this,arguments)}}(),T={id:"",title:""},i=n.record,k=n.trigger,L=n.onOk,H=function(){var j=h()(f()().mark(function O(d){var _,E,l,p,c,g;return f()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(d=R()(R()({},i),d),!(((_=d)===null||_===void 0?void 0:_.consumeQuantity)<=0)){I.next=4;break}return r.ZP===null||r.ZP===void 0||(c=r.ZP.error)===null||c===void 0||c.call(r.ZP,"\u9886\u7528\u6570\u91CF\u9700\u5927\u4E8E0, \u8BF7\u91CD\u8BD5!"),I.abrupt("return",!1);case 4:if(!(((E=d)===null||E===void 0?void 0:E.consumeQuantity)>((l=s)===null||l===void 0?void 0:l.quantity))){I.next=7;break}return r.ZP===null||r.ZP===void 0||(g=r.ZP.error)===null||g===void 0||g.call(r.ZP,"\u9886\u7528\u6570\u91CF\u9700\u5C0F\u4E8E\u7B49\u4E8E\u5E93\u5B58\u6570\u91CF, \u8BF7\u91CD\u8BD5!"),I.abrupt("return",!1);case 7:return(p=run)===null||p===void 0||p(d),I.abrupt("return",!0);case 9:case"end":return I.stop()}},O)}));return function(d){return j.apply(this,arguments)}}(),W=[{valueType:"group",columns:[{title:"\u9886\u7528\u6570\u91CF",dataIndex:"consumeQuantity",valueType:"digit",tooltip:"\u6B63\u6570",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"},{type:"number",min:0,message:"\u8BF7\u8F93\u5165\u6B63\u6570"}]},width:"m",initialValue:1}]}];return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(C.Y,{formRef:t,onFinish:H,modalProps:{destroyOnClose:!0,okButtonProps:{loading}},onOpenChange:a,initialValues:T,title:"\u9886\u7528\u51FA\u5E93\u5355",trigger:k,children:(0,m.jsx)($.Z,{layoutType:"Embed",columns:W})})})},N=e(97131),J=e(30077),X=e(14726),q=[{valueType:"group",columns:[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m"},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m"}]},{valueType:"group",columns:[{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m"},{title:"\u5931\u6548\u671F",dataIndex:"exp",sorter:!0,valueType:"date",tooltip:"\u65E5\u671F",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5931\u6548\u671F"}]},width:"m"}]}],P=e(19515),ee=function(){var n,u,t=(0,y.useState)(""),s=S()(t,2),a=s[0],T=s[1],i=(n=y.useRef)===null||n===void 0?void 0:n(),k=y.useState===null||y.useState===void 0?void 0:(0,y.useState)([]),L=S()(k,2),H=L[0],W=L[1],j=o.useIntl===null||o.useIntl===void 0?void 0:(0,o.useIntl)(),O=r.ZP===null||r.ZP===void 0||(u=r.ZP.useMessage)===null||u===void 0?void 0:u.call(r.ZP),d=S()(O,2),_=d[0],E=d[1],l=[].concat(A()(P.P===null||P.P===void 0?void 0:(0,P.P)(q)),[{title:(0,m.jsx)(o.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(g,v){return[(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(z,{record:v,onOk:p,trigger:(0,m.jsx)(X.ZP,{type:"primary",children:"\u9886\u7528\u51FA\u5E93"})})})]}}]),p=function(){var g;T==null||T(P.V===null||P.V===void 0?void 0:(0,P.V)()),i==null||(g=i.current)===null||g===void 0||g.reload()};return y.useEffect===null||y.useEffect===void 0||(0,y.useEffect)(function(){T==null||T(P.V===null||P.V===void 0?void 0:(0,P.V)())},[]),(0,m.jsxs)(N._z,{children:[E,(0,m.jsx)(J.Z,{headerTitle:j==null?void 0:j.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:i,rowKey:"id",toolBarRender:function(){return[]},request:Q,columns:l,rowSelection:{onChange:function(g,v){W(v)}}})]})}},19515:function(Y,M,e){e.d(M,{P:function(){return R},V:function(){return D}});var w=e(64599),A=e.n(w),F=e(19632),S=e.n(F),Z=e(27484),f=e.n(Z);function D(){var b=f()().format("YYYYMMDDHHmmssSSS").toString();return b}function R(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],h=S()(b),C=A()(h),$;try{for(C.s();!($=C.n()).done;){var r=$.value;!(r!=null&&r.valueType)||(r==null?void 0:r.valueType)!=="group"||!(r!=null&&r.columns)||!(r!=null&&r.columns.length)||h.push.apply(h,S()(r==null?void 0:r.columns))}}catch(o){C.e(o)}finally{C.f()}return h.filter(function(o){return o.valueType!=="group"})}}}]);
