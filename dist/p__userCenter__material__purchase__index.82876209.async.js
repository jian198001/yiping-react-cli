"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[428],{60419:function($e,me,t){t.r(me),t.d(me,{default:function(){return vr}});var pe=t(15009),R=t.n(pe),he=t(99289),_=t.n(he),ge=t(5574),N=t.n(ge),Z=t(97857),te=t.n(Z),ae=t(37476),se=t(26855),ue=t(30077),g=t(2453),b=t(28248),ne=t(14726),S=t(6493),F=t(12578),h=t(67294),Se=[{valueType:"group",columns:[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},width:"m"}]}];function fe(e,d,s){return ye.apply(this,arguments)}function ye(){return ye=_()(R()().mark(function e(d,s,j){var a;return R()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return a="/staff/web/userCenter/purchase/material/page.json",x.abrupt("return",F.request===null||F.request===void 0?void 0:(0,F.request)(a,{method:"GET",params:{params:d,sort:s,filter:j}}));case 2:case"end":return x.stop()}},e)})),ye.apply(this,arguments)}function Pe(e){return we.apply(this,arguments)}function we(){return we=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var s;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="/staff/web/userCenter/purchase/material/update.json",a.abrupt("return",request==null?void 0:request(s,{method:"POST",data:d}));case 2:case"end":return a.stop()}},e)})),we.apply(this,arguments)}function Ee(e){return _e.apply(this,arguments)}function _e(){return _e=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var s;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="/staff/web/userCenter/purchase/material/getById.json",a.abrupt("return",request==null?void 0:request(s,{method:"GET",params:{id:d}}));case 2:case"end":return a.stop()}},e)})),_e.apply(this,arguments)}function Oe(e){return Re.apply(this,arguments)}function Re(){return Re=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var s;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="/staff/web/userCenter/purchase/material/del.json",a.abrupt("return",request==null?void 0:request(s,{method:"POST",data:_objectSpread({},d)}));case 2:case"end":return a.stop()}},e)})),Re.apply(this,arguments)}function Ce(e,d,s,j){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function e(d,s,j,a){var p;return _regeneratorRuntime().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return p="/staff/web/userCenter/purchase/materialItem/page.json?orderId="+d,B.abrupt("return",request==null?void 0:request(p,{method:"GET",params:{params:s,sort:j,filter:a}}));case 2:case"end":return B.stop()}},e)})),P.apply(this,arguments)}function V(e){return w.apply(this,arguments)}function w(){return w=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var s;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="/staff/web/userCenter/purchase/material/updateItem.json",a.abrupt("return",request==null?void 0:request(s,{method:"POST",data:d}));case 2:case"end":return a.stop()}},e)})),w.apply(this,arguments)}function z(e){return f.apply(this,arguments)}function f(){return f=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var s;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="/staff/web/userCenter/purchase/material/submit.json?id="+d,a.abrupt("return",request==null?void 0:request(s,{method:"POST"}));case 2:case"end":return a.stop()}},e)})),f.apply(this,arguments)}function Ze(e){return oe.apply(this,arguments)}function oe(){return oe=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var s;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="/staff/web/userCenter/inventory/inbill/purchaseInstock.json",a.abrupt("return",request==null?void 0:request(s,{method:"POST",data:d}));case 2:case"end":return a.stop()}},e)})),oe.apply(this,arguments)}var n=t(85893),Ke=function(e){var d,s=(0,h.useState)({}),j=N()(s,2),a=j[0],p=j[1],x=(d=h.useRef)===null||d===void 0?void 0:d(),B=function(){var u=_()(R()().mark(function I(){var o,A,O,ee,ie,de;return R()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,fe==null?void 0:fe({},{},{});case 2:if(o=W.sent,console.log(o==null?void 0:o.data),p==null||p(o==null?void 0:o.data),!X){W.next=12;break}return W.next=8,S.FO===null||S.FO===void 0?void 0:(0,S.FO)(X);case 8:if(ee=W.sent,!(ee!=null&&ee.data)){W.next=11;break}return W.abrupt("return",x==null||(ie=x.current)===null||ie===void 0||(de=ie.setFieldsValue)===null||de===void 0?void 0:de.call(ie,te()({},ee==null?void 0:ee.data)));case 11:return W.abrupt("return",x==null||(A=x.current)===null||A===void 0||(O=A.setFieldsValue)===null||O===void 0?void 0:O.call(A,{id:X,orderId:K}));case 12:case"end":return W.stop()}},I)}));return function(){return u.apply(this,arguments)}}(),Q={id:"",title:"",orderId:""},X=e.id,le=e.trigger,re=e.onOk,K=e.orderId,k=F.useRequest===null||F.useRequest===void 0?void 0:(0,F.useRequest)(S.$G,{manual:!0,onSuccess:function(){var I;g.ZP===null||g.ZP===void 0||(I=g.ZP.success)===null||I===void 0||I.call(g.ZP,"\u63D0\u4EA4\u6210\u529F"),re==null||re()},onError:function(){var I;g.ZP===null||g.ZP===void 0||(I=g.ZP.error)===null||I===void 0||I.call(g.ZP,"\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),H=k.run,Y=k.loading,D=function(){var u=_()(R()().mark(function I(o){return R()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return o=te()(te()({},o),{},{id:X,orderId:K}),H==null||H(o),O.abrupt("return",!0);case 3:case"end":return O.stop()}},I)}));return function(o){return u.apply(this,arguments)}}(),G={input:{text:"\u521B\u5EFA\u65B0\u7269\u6599"},radio:{text:"\u4ECE\u5DF2\u6709\u7269\u6599\u4E2D\u9009\u62E9"}},E=[{valueType:"group",columns:[{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0},{title:"\u91C7\u8D2D\u65B9\u5F0F",dataIndex:"type",sorter:!0,valueType:"select",valueEnum:G,formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u91C7\u8D2D\u65B9\u5F0F"}]},width:"m",hideInSearch:!0},{valueType:"dependency",name:["type"],columns:function(I){var o=I.type;return o==="input"?[{valueType:"group",columns:[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"name",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0},{title:"\u89C4 \u683C",dataIndex:"sku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m",hideInSearch:!0}]}]:o==="radio"?[{title:"\u7269\u6599\u540D\u79F0\u53CA\u89C4\u683C",dataIndex:"materialId",sorter:!0,valueType:"select",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7269\u6599\u540D\u79F0\u53CA\u89C4\u683C"}]},width:"m",hideInSearch:!0,valueEnum:a}]:[]}}]}];return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ae.Y,{formRef:x,onFinish:D,modalProps:{destroyOnClose:!0,okButtonProps:{loading:Y}},onOpenChange:B,initialValues:Q,title:"\u7F16\u8F91\u91C7\u8D2D\u660E\u7EC6\u5355",trigger:le,children:(0,n.jsx)(se.Z,{layoutType:"Embed",columns:E})})})},ce=t(19515),Te=function(e){var d,s,j,a=(d=h.useRef)===null||d===void 0?void 0:d(),p=(s=h.useRef)===null||s===void 0?void 0:s(),x=h.useState===null||h.useState===void 0?void 0:(0,h.useState)([]),B=N()(x,2),Q=B[0],X=B[1],le=g.ZP===null||g.ZP===void 0||(j=g.ZP.useMessage)===null||j===void 0?void 0:j.call(g.ZP),re=N()(le,2),K=re[0],k=re[1],H=F.useRequest===null||F.useRequest===void 0?void 0:(0,F.useRequest)(S.IV,{manual:!0,onSuccess:function(){var i,l,r;X==null||X([]),p==null||(i=p.current)===null||i===void 0||(l=i.reload)===null||l===void 0||l.call(i),K==null||(r=K.success)===null||r===void 0||r.call(K,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var i;K==null||(i=K.error)===null||i===void 0||i.call(K,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),Y=H.run,D=H._,G=function(){var L=_()(R()().mark(function i(){var l,r,$,U,v,C;return R()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(p==null||(l=p.current)===null||l===void 0||l.reload(),!u){c.next=8;break}return c.next=4,S.FO===null||S.FO===void 0?void 0:(0,S.FO)(u);case 4:if(U=c.sent,!(U!=null&&U.data)){c.next=7;break}return c.abrupt("return",a==null||(v=a.current)===null||v===void 0||(C=v.setFieldsValue)===null||C===void 0?void 0:C.call(v,te()({},U==null?void 0:U.data)));case 7:return c.abrupt("return",a==null||(r=a.current)===null||r===void 0||($=r.setFieldsValue)===null||$===void 0?void 0:$.call(r,{id:u,title:"\u91C7\u8D2D\u5355"+u}));case 8:case"end":return c.stop()}},i)}));return function(){return L.apply(this,arguments)}}(),E={id:"",title:""},u=e.id,I=e.trigger,o=e.onOk,A=F.useRequest===null||F.useRequest===void 0?void 0:(0,F.useRequest)(S.Vx,{manual:!0,onSuccess:function(){var i;g.ZP===null||g.ZP===void 0||(i=g.ZP.success)===null||i===void 0||i.call(g.ZP,"\u63D0\u4EA4\u6210\u529F"),o==null||o()},onError:function(){var i;g.ZP===null||g.ZP===void 0||(i=g.ZP.error)===null||i===void 0||i.call(g.ZP,"\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),O=A.run,ee=A.loading,ie=function(){var L=_()(R()().mark(function i(l){return R()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return l=te()(te()({},l),{},{id:u}),O==null||O(l),$.abrupt("return",!0);case 3:case"end":return $.stop()}},i)}));return function(l){return L.apply(this,arguments)}}(),de=(0,h.useCallback)(function(){var L=_()(R()().mark(function i(l){var r;return R()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:b.Z===null||b.Z===void 0||(r=b.Z.confirm)===null||r===void 0||r.call(b.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8FD9"+(l==null?void 0:l.length)+"\u9879\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D",onOk:function(){var C;(C=function(){var m=_()(R()().mark(function c(){var y;return R()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,Y==null?void 0:Y(l==null||(y=l.map)===null||y===void 0?void 0:y.call(l,function(J){return J==null?void 0:J.id}));case 2:case"end":return M.stop()}},c)}));return function(){return m.apply(this,arguments)}}())===null||C===void 0||C()}});case 1:case"end":return U.stop()}},i)}));return function(i){return L.apply(this,arguments)}}(),[Y]),ve=[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m",hideInSearch:!0},{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0}],W=function(){var i;p==null||(i=p.current)===null||i===void 0||i.reload()},Ie=function(){var L=_()(R()().mark(function i(l){var r;return R()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,S.ZI===null||S.ZI===void 0?void 0:(0,S.ZI)(u,l,null,null);case 2:return r=U.sent,U.abrupt("return",r);case 4:case"end":return U.stop()}},i)}));return function(l){return L.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(ae.Y,{formRef:a,onFinish:ie,modalProps:{destroyOnClose:!0,okButtonProps:{loading:ee}},onOpenChange:G,initialValues:E,title:"\u7F16\u8F91\u4FE1\u606F",trigger:I,children:[(0,n.jsx)(se.Z,{layoutType:"Embed",columns:Se}),(0,n.jsx)(ue.Z,{headerTitle:"\u660E\u7EC6\u8868\u683C",rowKey:"id",search:!1,actionRef:p,toolBarRender:function(){return[(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(ne.ZP,{danger:!0,disabled:!Q||!Q.length,onClick:function(){de(Q)},children:"\u5220 \u9664"}),(0,n.jsx)(Ke,{orderId:u,id:function(){return(0,ce.V)()},onOk:W,trigger:(0,n.jsx)(ne.ZP,{type:"primary",children:" \u65B0\u5EFA\u660E\u7EC6 "})})]})]},columns:ve,request:Ie})]})})},Ge=t(19632),Ue=t.n(Ge),Le=t(4942),We=t(97685),Fe=t(91),xe=t(74165),Ne=t(15861),q=t(1413),He=t(87462),Ye=t(42110),Je=t(32867),ze=function(d,s){return h.createElement(Je.Z,(0,He.Z)({},d,{ref:s,icon:Ye.Z}))},Qe=h.forwardRef(ze),Xe=Qe,er=t(97462),rr=t(952),nr=t(10915),Me=t(48171),tr=t(53914),ke=t(22270),ur=t(23491),ar=t(53025),lr=t(21770),je=t(88306),De=t(8880),ir=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],sr=["record","position","creatorButtonText","newRecordType","parentKey","style"],Ve=h.createContext(void 0);function qe(e){var d=e.children,s=e.record,j=e.position,a=e.newRecordType,p=e.parentKey,x=(0,h.useContext)(Ve);return h.cloneElement(d,(0,q.Z)((0,q.Z)({},d.props),{},{onClick:function(){var B=(0,Ne.Z)((0,xe.Z)().mark(function X(le){var re,K,k,H;return(0,xe.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(re=(K=d.props).onClick)===null||re===void 0?void 0:re.call(K,le);case 2:if(H=D.sent,H!==!1){D.next=5;break}return D.abrupt("return");case 5:x==null||(k=x.current)===null||k===void 0||k.addEditRecord(s,{position:j,newRecordType:a,parentKey:p});case 6:case"end":return D.stop()}},X)}));function Q(X){return B.apply(this,arguments)}return Q}()}))}function Ae(e){var d,s,j=(0,nr.YB)(),a=e.onTableChange,p=e.maxLength,x=e.formItemProps,B=e.recordCreatorProps,Q=e.rowKey,X=e.controlled,le=e.defaultValue,re=e.onChange,K=e.editableFormRef,k=(0,Fe.Z)(e,ir),H=(0,h.useRef)(void 0),Y=(0,h.useRef)(),D=(0,h.useRef)();(0,h.useImperativeHandle)(k.actionRef,function(){return Y.current},[Y.current]);var G=(0,lr.Z)(function(){return e.value||le||[]},{value:e.value,onChange:e.onChange}),E=(0,We.Z)(G,2),u=E[0],I=E[1],o=h.useMemo(function(){return typeof Q=="function"?Q:function(v,C){return v[Q]||C}},[Q]),A=(0,Me.J)(function(v){if(typeof v=="number"&&!e.name){if(v>=u.length)return v;var C=u&&u[v];return o==null?void 0:o(C,v)}if((typeof v=="string"||v>=u.length)&&e.name){var m=u.findIndex(function(c,y){var T;return(o==null||(T=o(c,y))===null||T===void 0?void 0:T.toString())===(v==null?void 0:v.toString())});if(m!==-1)return m}return v});(0,h.useImperativeHandle)(K,function(){var v=function(c){var y,T;if(c==null)throw new Error("rowIndex is required");var M=A(c),J=[e.name,(y=M==null?void 0:M.toString())!==null&&y!==void 0?y:""].flat(1).filter(Boolean);return(T=D.current)===null||T===void 0?void 0:T.getFieldValue(J)},C=function(){var c,y=[e.name].flat(1).filter(Boolean);if(Array.isArray(y)&&y.length===0){var T,M=(T=D.current)===null||T===void 0?void 0:T.getFieldsValue();return Array.isArray(M)?M:Object.keys(M).map(function(J){return M[J]})}return(c=D.current)===null||c===void 0?void 0:c.getFieldValue(y)};return(0,q.Z)((0,q.Z)({},D.current),{},{getRowData:v,getRowsData:C,setRowData:function(c,y){var T,M;if(c==null)throw new Error("rowIndex is required");var J=A(c),be=[e.name,(T=J==null?void 0:J.toString())!==null&&T!==void 0?T:""].flat(1).filter(Boolean),fr=Object.assign({},(0,q.Z)((0,q.Z)({},v(c)),y||{})),mr=(0,De.Z)({},be,fr);return(M=D.current)===null||M===void 0||M.setFieldsValue(mr),!0}})},[A,e.name,D.current]),(0,h.useEffect)(function(){e.controlled&&(u||[]).forEach(function(v,C){var m;(m=D.current)===null||m===void 0||m.setFieldsValue((0,Le.Z)({},"".concat(o(v,C)),v))},{})},[(0,tr.ZP)(u),e.controlled]),(0,h.useEffect)(function(){if(e.name){var v;D.current=e==null||(v=e.editable)===null||v===void 0?void 0:v.form}},[(d=e.editable)===null||d===void 0?void 0:d.form,e.name]);var O=B||{},ee=O.record,ie=O.position,de=O.creatorButtonText,ve=O.newRecordType,W=O.parentKey,Ie=O.style,L=(0,Fe.Z)(O,sr),i=ie==="top",l=(0,h.useMemo)(function(){return typeof p=="number"&&p<=(u==null?void 0:u.length)?!1:B!==!1&&(0,n.jsx)(qe,{record:(0,ke.h)(ee,u==null?void 0:u.length,u)||{},position:ie,parentKey:(0,ke.h)(W,u==null?void 0:u.length,u),newRecordType:ve,children:(0,n.jsx)(ne.ZP,(0,q.Z)((0,q.Z)({type:"dashed",style:(0,q.Z)({display:"block",margin:"10px 0",width:"100%"},Ie),icon:(0,n.jsx)(Xe,{})},L),{},{children:de||j.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[B,p,u==null?void 0:u.length]),r=(0,h.useMemo)(function(){return l?i?{components:{header:{wrapper:function(C){var m,c=C.className,y=C.children;return(0,n.jsxs)("thead",{className:c,children:[y,(0,n.jsxs)("tr",{style:{position:"relative"},children:[(0,n.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:l}),(0,n.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(m=k.columns)===null||m===void 0?void 0:m.length,children:l})]})]})}}}}:{tableViewRender:function(C,m){var c,y;return(0,n.jsxs)(n.Fragment,{children:[(c=(y=e.tableViewRender)===null||y===void 0?void 0:y.call(e,C,m))!==null&&c!==void 0?c:m,l]})}}:{}},[i,l]),$=(0,q.Z)({},e.editable),U=(0,Me.J)(function(v,C){var m,c,y;if((m=e.editable)===null||m===void 0||(c=m.onValuesChange)===null||c===void 0||c.call(m,v,C),(y=e.onValuesChange)===null||y===void 0||y.call(e,C,v),e.controlled){var T;e==null||(T=e.onChange)===null||T===void 0||T.call(e,C)}});return(e!=null&&e.onValuesChange||(s=e.editable)!==null&&s!==void 0&&s.onValuesChange||e.controlled&&e!==null&&e!==void 0&&e.onChange)&&($.onValuesChange=U),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ve.Provider,{value:Y,children:(0,n.jsx)(ue.Z,(0,q.Z)((0,q.Z)((0,q.Z)({search:!1,options:!1,pagination:!1,rowKey:Q,revalidateOnFocus:!1},k),r),{},{tableLayout:"fixed",actionRef:Y,onChange:a,editable:(0,q.Z)((0,q.Z)({},$),{},{formProps:(0,q.Z)({formRef:D},$.formProps)}),dataSource:u,onDataSourceChange:function(C){if(I(C),e.name&&ie==="top"){var m,c=(0,De.Z)({},[e.name].flat(1).filter(Boolean),C);(m=D.current)===null||m===void 0||m.setFieldsValue(c)}}}))}),e.name?(0,n.jsx)(er.Z,{name:[e.name],children:function(C){var m,c;if(!H.current)return H.current=u,null;var y=(0,je.Z)(C,[e.name].flat(1)),T=y==null?void 0:y.find(function(M,J){var be;return!(0,ur.A)(M,(be=H.current)===null||be===void 0?void 0:be[J])});return H.current=u,T&&(e==null||(m=e.editable)===null||m===void 0||(c=m.onValuesChange)===null||c===void 0||c.call(m,T,y)),null}}):null]})}function Be(e){var d=rr.ZP.useFormInstance();return e.name?(0,n.jsx)(ar.Z.Item,(0,q.Z)((0,q.Z)({style:{maxWidth:"100%"}},e==null?void 0:e.formItemProps),{},{name:e.name,shouldUpdate:function(j,a){var p=[e.name].flat(1);try{return JSON.stringify((0,je.Z)(j,p))!==JSON.stringify((0,je.Z)(a,p))}catch(x){return!0}},children:(0,n.jsx)(Ae,(0,q.Z)((0,q.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e),{},{editable:(0,q.Z)((0,q.Z)({},e.editable),{},{form:d})}))})):(0,n.jsx)(Ae,(0,q.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e))}Be.RecordCreator=qe;var or=Be,dr=function(e){var d,s=(d=h.useRef)===null||d===void 0?void 0:d(),j=function(){var G=_()(R()().mark(function E(){var u,I,o;return R()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!p){O.next=5;break}return O.next=3,S.FO===null||S.FO===void 0?void 0:(0,S.FO)(p);case 3:return o=O.sent,O.abrupt("return",s==null||(u=s.current)===null||u===void 0||(I=u.setFieldsValue)===null||I===void 0?void 0:I.call(u,{id:p,title:"\u91C7\u8D2D\u5165\u5E93\u5355"+(0,ce.V)()}));case 5:case"end":return O.stop()}},E)}));return function(){return G.apply(this,arguments)}}(),a={id:"",title:""},p=e.id,x=e.trigger,B=e.onOk,Q=F.useRequest===null||F.useRequest===void 0?void 0:(0,F.useRequest)(S.k9,{manual:!0,onSuccess:function(){var E;g.ZP===null||g.ZP===void 0||(E=g.ZP.success)===null||E===void 0||E.call(g.ZP,"\u63D0\u4EA4\u6210\u529F"),console.log("instock onok"),B==null||B()},onError:function(){var E;g.ZP===null||g.ZP===void 0||(E=g.ZP.error)===null||E===void 0||E.call(g.ZP,"\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),X=Q.run,le=Q.loading,re=function(){var G=_()(R()().mark(function E(u){return R()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return u=te()(te()({},u),{},{id:p,item:Y}),X==null||X(u),o.abrupt("return",!0);case 3:case"end":return o.stop()}},E)}));return function(u){return G.apply(this,arguments)}}(),K=function(E){Y=Ue()(E)},k=[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u5931\u6548\u671F",dataIndex:"exp",sorter:!0,valueType:"date",tooltip:"\u65E5\u671F",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5931\u6548\u671F"}]},width:"m",hideInSearch:!0},{title:(0,n.jsx)(F.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(E,u,I,o){return[(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ne.ZP,{type:"primary",onClick:function(){o.startEditable(u.id)},children:"\u7F16 \u8F91"})})]}}],H=[{valueType:"group",columns:[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},width:"m"}]}],Y=[],D=function(){var G=_()(R()().mark(function E(u){var I;return R()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,S.ZI===null||S.ZI===void 0?void 0:(0,S.ZI)(p,u,null,null);case 2:return I=A.sent,A.abrupt("return",I);case 4:case"end":return A.stop()}},E)}));return function(u){return G.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(ae.Y,{formRef:s,onFinish:re,modalProps:{destroyOnClose:!0,okButtonProps:{loading:le}},onOpenChange:j,initialValues:a,title:"\u7269\u6599\u5165\u5E93\u5355",trigger:x,children:[(0,n.jsx)(se.Z,{formRef:s,layoutType:"Embed",columns:H}),(0,n.jsx)(or,{headerTitle:"\u660E\u7EC6\u8868\u683C",rowKey:"id",search:!1,toolBarRender:function(){return[(0,n.jsx)(n.Fragment,{children:" "})]},columns:k,recordCreatorProps:!1,onChange:K,editable:{type:"multiple",actionRender:function(E,u,I){return[I.save,I.cancel]}},controlled:!0,request:D})]})})},cr=t(97131),vr=function(){var e,d,s=(0,h.useState)(""),j=N()(s,2),a=j[0],p=j[1],x=(0,h.useState)(""),B=N()(x,2),Q=B[0],X=B[1],le=(0,F.useModel)("@@initialState"),re=le.initialState.currentUser,K=re===void 0?{}:re,k=(e=h.useRef)===null||e===void 0?void 0:e(),H=h.useState===null||h.useState===void 0?void 0:(0,h.useState)([]),Y=N()(H,2),D=Y[0],G=Y[1],E=F.useIntl===null||F.useIntl===void 0?void 0:(0,F.useIntl)(),u=g.ZP===null||g.ZP===void 0||(d=g.ZP.useMessage)===null||d===void 0?void 0:d.call(g.ZP),I=N()(u,2),o=I[0],A=I[1],O=F.useRequest===null||F.useRequest===void 0?void 0:(0,F.useRequest)(S.IV,{manual:!0,onSuccess:function(){var l,r,$;G==null||G([]),k==null||(l=k.current)===null||l===void 0||(r=l.reload)===null||r===void 0||r.call(l),o==null||($=o.success)===null||$===void 0||$.call(o,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var l;o==null||(l=o.error)===null||l===void 0||l.call(o,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),ee=O.run,ie=O.loading,de=[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,width:"m"},{title:"\u660E\u7EC6\u6570",dataIndex:"itemCount",sorter:!0,hideInForm:!0},{title:"\u72B6 \u6001",dataIndex:"tradeState",sorter:!0,valueType:"select",hideInForm:!0,valueEnum:{edit:{text:"\u5F85\u63D0\u4EA4"},submit:{text:"\u5F85\u5165\u5E93"},stock:{text:"\u5DF2\u91C7\u8D2D\u5B8C\u6210"}}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"create_date",sorter:!0,hideInForm:!0,valueType:"date"},{title:"\u64CD\u4F5C\u8005",dataIndex:"username",sorter:!0,hideInForm:!0},{title:(0,n.jsx)(F.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(l,r){return[(0,n.jsxs)(n.Fragment,{children:[(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(0,n.jsx)(Te,{trigger:(0,n.jsx)(ne.ZP,{type:"primary",children:"\u7F16 \u8F91"}),id:r==null?void 0:r.id,onOk:L},r==null?void 0:r.id),(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(r==null?void 0:r.itemCount)>0&&(0,n.jsx)(ne.ZP,{type:"primary",onClick:function(){W==null||W(r)},onOk:L,children:"\u63D0 \u4EA4"}),(r==null?void 0:r.tradeState)==="submit"&&(0,n.jsx)(dr,{id:r==null?void 0:r.id,trigger:(0,n.jsx)(ne.ZP,{type:"primary",children:"\u5165 \u5E93"}),onOk:L}),(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(0,n.jsx)(ne.ZP,{onClick:function(){ve==null||ve(r)},danger:!0,onOk:L,children:"\u5220 \u9664"})]})]}}],ve=(0,h.useCallback)(function(){var i=_()(R()().mark(function l(r){var $;return R()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:b.Z===null||b.Z===void 0||($=b.Z.confirm)===null||$===void 0||$.call(b.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u6807\u9898\u4E3A".concat(r.title,"\u7684\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D"),onOk:function(){var m;(m=function(){var c=_()(R()().mark(function y(){return R()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,ee==null?void 0:ee([r==null?void 0:r.id]);case 2:case"end":return M.stop()}},y)}));return function(){return c.apply(this,arguments)}}())===null||m===void 0||m()}});case 1:case"end":return v.stop()}},l)}));return function(l){return i.apply(this,arguments)}}(),[ee]),W=(0,h.useCallback)(function(){var i=_()(R()().mark(function l(r){var $;return R()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:b.Z===null||b.Z===void 0||($=b.Z.confirm)===null||$===void 0||$.call(b.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u63D0\u4EA4\u6807\u9898\u4E3A".concat(r==null?void 0:r.title,"\u7684\u4FE1\u606F?\u63D0\u4EA4\u540E\u5C06\u4E0D\u53EF\u518D\u6B21\u7F16\u8F91"),onOk:function(){var m;(m=function(){var c=_()(R()().mark(function y(){var T;return R()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,S.Ps===null||S.Ps===void 0?void 0:(0,S.Ps)(r==null?void 0:r.id);case 2:k==null||(T=k.current)===null||T===void 0||T.reload();case 3:case"end":return J.stop()}},y)}));return function(){return c.apply(this,arguments)}}())===null||m===void 0||m()}});case 1:case"end":return v.stop()}},l)}));return function(l){return i.apply(this,arguments)}}(),[ee]),Ie=function(){var l;return!!(K!=null&&(l=K.roleIds)!==null&&l!==void 0&&l.includes("1"))},L=function(){var l;console.log("onOk"),k==null||(l=k.current)===null||l===void 0||l.reload(),p==null||p(ce.V===null||ce.V===void 0?void 0:(0,ce.V)())};return h.useEffect===null||h.useEffect===void 0||(0,h.useEffect)(function(){p==null||p(ce.V===null||ce.V===void 0?void 0:(0,ce.V)())},[]),(0,n.jsxs)(cr._z,{children:[A,(0,n.jsx)(ue.Z,{headerTitle:E==null?void 0:E.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:k,rowKey:"id",toolBarRender:function(){return[(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(Te,{trigger:(0,n.jsx)(ne.ZP,{type:"primary",disabled:!Ie(),children:" \u65B0\u5EFA\u91C7\u8D2D\u5355 "}),id:a,onOk:L})]})]},request:S.Md,columns:de,rowSelection:{onChange:function(l,r){G(r)}}})]})}},6493:function($e,me,t){t.d(me,{$G:function(){return ye},FO:function(){return g},IV:function(){return ne},Md:function(){return te},Ps:function(){return _e},Vx:function(){return se},ZI:function(){return Se},k9:function(){return Re}});var pe=t(97857),R=t.n(pe),he=t(15009),_=t.n(he),ge=t(99289),N=t.n(ge),Z=t(12578);function te(P,V,w){return ae.apply(this,arguments)}function ae(){return ae=N()(_()().mark(function P(V,w,z){var f;return _()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return f="/staff/web/userCenter/purchaseOrder/purchaseOrder/page.json",oe.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(f,{method:"GET",params:{params:V,sort:w,filter:z}}));case 2:case"end":return oe.stop()}},P)})),ae.apply(this,arguments)}function se(P){return ue.apply(this,arguments)}function ue(){return ue=N()(_()().mark(function P(V){var w;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return w="/staff/web/userCenter/purchaseOrder/purchaseOrder/update.json",f.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(w,{method:"POST",data:V}));case 2:case"end":return f.stop()}},P)})),ue.apply(this,arguments)}function g(P){return b.apply(this,arguments)}function b(){return b=N()(_()().mark(function P(V){var w;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return w="/staff/web/userCenter/purchaseOrder/purchaseOrder/getById.json",f.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(w,{method:"GET",params:{id:V}}));case 2:case"end":return f.stop()}},P)})),b.apply(this,arguments)}function ne(P){return S.apply(this,arguments)}function S(){return S=N()(_()().mark(function P(V){var w;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return w="/staff/web/userCenter/purchaseOrder/purchaseOrder/del.json",f.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(w,{method:"POST",data:R()({},V)}));case 2:case"end":return f.stop()}},P)})),S.apply(this,arguments)}function F(){return h.apply(this,arguments)}function h(){return h=_asyncToGenerator(_regeneratorRuntime().mark(function P(){var V;return _regeneratorRuntime().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return V="/staff/web/userCenter/purchaseOrder/purchaseOrder/page.json",z.abrupt("return",request==null?void 0:request(V,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return z.stop()}},P)})),h.apply(this,arguments)}function Se(P,V,w,z){return fe.apply(this,arguments)}function fe(){return fe=N()(_()().mark(function P(V,w,z,f){var Ze;return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Ze="/staff/web/userCenter/purchaseOrder/purchaseOrderItem/page.json?orderId="+V,n.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(Ze,{method:"GET",params:{params:w,sort:z,filter:f}}));case 2:case"end":return n.stop()}},P)})),fe.apply(this,arguments)}function ye(P){return Pe.apply(this,arguments)}function Pe(){return Pe=N()(_()().mark(function P(V){var w;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return w="/staff/web/userCenter/purchaseOrder/purchaseOrder/updateItem.json",f.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(w,{method:"POST",data:V}));case 2:case"end":return f.stop()}},P)})),Pe.apply(this,arguments)}function we(P){return Ee.apply(this,arguments)}function Ee(){return Ee=_asyncToGenerator(_regeneratorRuntime().mark(function P(V){var w;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return w="/staff/web/userCenter/purchaseOrder/purchaseOrder/del.json",f.abrupt("return",request==null?void 0:request(w,{method:"POST",data:_objectSpread({},V)}));case 2:case"end":return f.stop()}},P)})),Ee.apply(this,arguments)}function _e(P){return Oe.apply(this,arguments)}function Oe(){return Oe=N()(_()().mark(function P(V){var w;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return w="/staff/web/userCenter/purchaseOrder/purchaseOrder/submit.json?id="+V,f.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(w,{method:"POST"}));case 2:case"end":return f.stop()}},P)})),Oe.apply(this,arguments)}function Re(P){return Ce.apply(this,arguments)}function Ce(){return Ce=N()(_()().mark(function P(V){var w;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return w="/staff/web/userCenter/inventory/inbill/purchaseInstock.json",f.abrupt("return",Z.request===null||Z.request===void 0?void 0:(0,Z.request)(w,{method:"POST",data:V}));case 2:case"end":return f.stop()}},P)})),Ce.apply(this,arguments)}},19515:function($e,me,t){t.d(me,{P:function(){return te},V:function(){return Z}});var pe=t(64599),R=t.n(pe),he=t(19632),_=t.n(he),ge=t(27484),N=t.n(ge);function Z(){var ae=N()().format("YYYYMMDDHHmmssSSS").toString();return ae}function te(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],se=_()(ae),ue=R()(se),g;try{for(ue.s();!(g=ue.n()).done;){var b=g.value;!(b!=null&&b.valueType)||(b==null?void 0:b.valueType)!=="group"||!(b!=null&&b.columns)||!(b!=null&&b.columns.length)||se.push.apply(se,_()(b==null?void 0:b.columns))}}catch(ne){ue.e(ne)}finally{ue.f()}return se.filter(function(ne){return ne.valueType!=="group"})}}}]);
