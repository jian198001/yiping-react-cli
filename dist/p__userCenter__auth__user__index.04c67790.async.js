"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[355],{25171:function(pe,W,e){e.r(W),e.d(W,{default:function(){return X}});var H=e(15009),c=e.n(H),J=e(99289),s=e.n(J),z=e(19632),b=e.n(z),a=e(5574),C=e.n(a),M=e(97857),T=e.n(M),w=e(37476),k=e(26855),i=e(24982),d=e(67294),B=e(51876),v=e(85893),K=function(A){var Z,ae=(0,d.useState)({}),V=C()(ae,2),ie=V[0],oe=V[1],E=(Z=d.useRef)===null||Z===void 0?void 0:Z(),ee=(0,d.useState)(!1),G=C()(ee,2),x=G[0],re=G[1],q=function(){var p=s()(c()().mark(function O(){var $,_,D,f,j,y,te;return c()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,B.ah)();case 2:if($=P.sent,_=$.data,console.log(_),oe(_),!U){P.next=13;break}return P.next=9,i.FO===null||i.FO===void 0?void 0:(0,i.FO)(U);case 9:if(j=P.sent,!(j!=null&&j.data)){P.next=12;break}return P.abrupt("return",E==null||(y=E.current)===null||y===void 0||(te=y.setFieldsValue)===null||te===void 0?void 0:te.call(y,T()({},j==null?void 0:j.data)));case 12:return P.abrupt("return",E==null||(D=E.current)===null||D===void 0||(f=D.setFieldsValue)===null||f===void 0?void 0:f.call(D,{id:U}));case 13:case"end":return P.stop()}},O)}));return function(){return p.apply(this,arguments)}}(),ue={id:"",title:""},U=A.id,ne=A.trigger,de=A.onOk,Y=[{valueType:"group",columns:[{title:"\u7528\u6237\u540D",dataIndex:"username",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]},{valueType:"group",columns:[{title:"\u5BC6 \u7801",dataIndex:"password",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"},{title:"\u786E\u8BA4\u5BC6\u7801",dataIndex:"confirmPassword",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"}]},{valueType:"group",columns:[{title:"\u89D2 \u8272",dataIndex:"roleIds",sorter:!0,valueType:"select",hideInTable:!0,hideInSearch:!0,mode:"multiple",formItemProps:{mode:"multiple"},fieldProps:{mode:"multiple"},valueEnum:ie}]}],m=function(){var p=s()(c()().mark(function O($){var _;return c()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return re(!0),$=T()(T()({},$),{},{id:U}),(_=run)===null||_===void 0||_($),f.abrupt("return",!0);case 4:case"end":return f.stop()}},O)}));return function($){return p.apply(this,arguments)}}();return(0,v.jsx)(w.Y,{formRef:E,onFinish:m,modalProps:{destroyOnClose:!0,okButtonProps:{loading:x}},onOpenChange:q,initialValues:ue,title:"\u7F16\u8F91\u4FE1\u606F",trigger:ne,children:(0,v.jsx)(k.Z,{layoutType:"Embed",columns:Y})})},h=e(97131),g=e(30077),r=e(12578),t=e(2453),u=e(14726),I=e(28248),n=e(19515),fe=function(A){var Z,ae=(0,d.useState)({}),V=C()(ae,2),ie=V[0],oe=V[1],E=(Z=d.useRef)===null||Z===void 0?void 0:Z(),ee=function(){var m=s()(c()().mark(function p(){var O,$,_,D,f,j,y;return c()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,B.ah)();case 2:if(O=R.sent,$=O.data,console.log($),oe($),!x){R.next=13;break}return R.next=9,i.FO===null||i.FO===void 0?void 0:(0,i.FO)(x);case 9:if(f=R.sent,!(f!=null&&f.data)){R.next=12;break}return R.abrupt("return",E==null||(j=E.current)===null||j===void 0||(y=j.setFieldsValue)===null||y===void 0?void 0:y.call(j,T()({},f==null?void 0:f.data)));case 12:return R.abrupt("return",E==null||(_=E.current)===null||_===void 0||(D=_.setFieldsValue)===null||D===void 0?void 0:D.call(_,{id:x}));case 13:case"end":return R.stop()}},p)}));return function(){return m.apply(this,arguments)}}(),G={id:"",title:""},x=A.id,re=A.trigger,q=A.onOk,ue=r.useRequest===null||r.useRequest===void 0?void 0:(0,r.useRequest)(i.Vx,{manual:!0,onSuccess:function(){var p;t.ZP===null||t.ZP===void 0||(p=t.ZP.success)===null||p===void 0||p.call(t.ZP,"\u63D0\u4EA4\u6210\u529F"),q==null||q()},onError:function(){var p;t.ZP===null||t.ZP===void 0||(p=t.ZP.error)===null||p===void 0||p.call(t.ZP,"\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),U=ue.run,ne=ue.loading,de=[{valueType:"group",columns:[{title:"\u7528\u6237\u540D",dataIndex:"username",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]},{valueType:"group",columns:[{title:"\u5BC6 \u7801",dataIndex:"password",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"},{title:"\u786E\u8BA4\u5BC6\u7801",dataIndex:"confirmPassword",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"}]},{valueType:"group",columns:[{title:"\u89D2 \u8272",dataIndex:"roleIds",sorter:!0,valueType:"select",hideInTable:!0,hideInSearch:!0,mode:"multiple",formItemProps:{mode:"multiple"},fieldProps:{mode:"multiple"},valueEnum:ie}]}],Y=function(){var m=s()(c()().mark(function p(O){return c()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return O=T()(T()({},O),{},{id:x}),U==null||U(O),_.abrupt("return",!0);case 3:case"end":return _.stop()}},p)}));return function(O){return m.apply(this,arguments)}}();return(0,v.jsx)(w.Y,{formRef:E,onFinish:Y,modalProps:{destroyOnClose:!0,okButtonProps:{loading:ne}},onOpenChange:ee,initialValues:G,title:"\u7F16\u8F91\u4FE1\u606F",trigger:re,children:(0,v.jsx)(k.Z,{layoutType:"Embed",columns:de})})},X=function(){var A,Z,ae=(0,d.useState)(""),V=C()(ae,2),ie=V[0],oe=V[1],E=(0,r.useModel)("@@initialState"),ee=E.initialState.currentUser,G=ee===void 0?{}:ee,x=(0,d.useState)({}),re=C()(x,2),q=re[0],ue=re[1],U=(0,d.useState)(""),ne=C()(U,2),de=ne[0],Y=ne[1],m=(A=d.useRef)===null||A===void 0?void 0:A(),p=d.useState===null||d.useState===void 0?void 0:(0,d.useState)([]),O=C()(p,2),$=O[0],_=O[1],D=r.useIntl===null||r.useIntl===void 0?void 0:(0,r.useIntl)(),f=t.ZP===null||t.ZP===void 0||(Z=t.ZP.useMessage)===null||Z===void 0?void 0:Z.call(t.ZP),j=C()(f,2),y=j[0],te=j[1],R=r.useRequest===null||r.useRequest===void 0?void 0:(0,r.useRequest)(i.IV,{manual:!0,onSuccess:function(){var o,l,S;_==null||_([]),m==null||(o=m.current)===null||o===void 0||(l=o.reload)===null||l===void 0||l.call(o),y==null||(S=y.success)===null||S===void 0||S.call(y,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var o;y==null||(o=y.error)===null||o===void 0||o.call(y,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),P=R.run,Ie=R.loading,he=[{valueType:"group",columns:[{title:"\u7528\u6237\u540D",dataIndex:"username",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]},{valueType:"group",columns:[{title:"\u5BC6 \u7801",dataIndex:"password",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"},{title:"\u786E\u8BA4\u5BC6\u7801",dataIndex:"confirmPassword",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"}]},{valueType:"group",columns:[{title:"\u89D2 \u8272",dataIndex:"roleIds",sorter:!0,valueType:"select",hideInTable:!0,hideInSearch:!0,formItemProps:{mode:"multiple"},valueEnum:q}]}],ge=[].concat(b()(n.P===null||n.P===void 0?void 0:(0,n.P)(he)),[{title:(0,v.jsx)(r.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(o,l){var S;return[(0,v.jsx)(K,{trigger:(0,v.jsx)(u.ZP,{type:"primary",disabled:(l==null?void 0:l.username)==="admin"||!ce(),children:"\u7F16 \u8F91"}),id:l==null?void 0:l.id,onOk:m==null||(S=m.current)===null||S===void 0?void 0:S.reload},l==null?void 0:l.id),(0,v.jsx)(u.ZP,{disabled:(l==null?void 0:l.username)==="admin"||!ce(),onClick:function(){ye(l)},children:"\u5BC6\u7801\u91CD\u7F6E"}),(0,v.jsx)(u.ZP,{danger:!0,onClick:function(){Ee(l)},disabled:(l==null?void 0:l.username)==="admin"||!ce(),children:"\u5220 \u9664"})]}}]),Ee=(0,d.useCallback)(function(){var F=s()(c()().mark(function o(l){var S;return c()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:I.Z===null||I.Z===void 0||(S=I.Z.confirm)===null||S===void 0||S.call(I.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u7528\u6237\u540D\u4E3A".concat(l.username,"\u7684\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D"),onOk:function(){var Q;(Q=function(){var le=s()(c()().mark(function _e(){return c()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,P==null?void 0:P([l==null?void 0:l.id]);case 2:case"end":return se.stop()}},_e)}));return function(){return le.apply(this,arguments)}}())===null||Q===void 0||Q()}});case 1:case"end":return N.stop()}},o)}));return function(o){return F.apply(this,arguments)}}(),[P]),ye=(0,d.useCallback)(function(){var F=s()(c()().mark(function o(l){var S;return c()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:I.Z===null||I.Z===void 0||(S=I.Z.confirm)===null||S===void 0||S.call(I.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u91CD\u7F6E\u7528\u6237\u540D\u4E3A".concat(l.username,"\u7684\u5BC6\u7801?\u91CD\u7F6E\u540E\u6B64\u7528\u6237\u5BC6\u7801\u5C06\u4E3A\u521D\u59CB\u5BC6\u7801aaaa1111"),onOk:function(){var Q,le;(Q=function(){var _e=s()(c()().mark(function me(){return c()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.next=2,i.J$===null||i.J$===void 0?void 0:(0,i.J$)(l==null?void 0:l.id);case 2:case"end":return ve.stop()}},me)}));return function(){return _e.apply(this,arguments)}}())===null||Q===void 0||Q(),t.ZP===null||t.ZP===void 0||(le=t.ZP.success)===null||le===void 0||le.call(t.ZP,"\u63D0\u4EA4\u6210\u529F")}});case 1:case"end":return N.stop()}},o)}));return function(o){return F.apply(this,arguments)}}(),[P]),Pe=function(){var o;Y==null||Y(n.V===null||n.V===void 0?void 0:(0,n.V)()),m==null||(o=m.current)===null||o===void 0||o.reload()},ce=function(){var o;return G!=null&&(o=G.roleIds)!==null&&o!==void 0&&o.includes("1")?(console.log("isAdmin"),!0):!1};return d.useEffect===null||d.useEffect===void 0||(0,d.useEffect)(function(){Y((0,n.V)()),s()(c()().mark(function F(){var o,l;return c()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,B.ah)();case 2:o=L.sent,l=o.data,console.log(l),ue(l);case 6:case"end":return L.stop()}},F)}))()},[]),(0,v.jsxs)(h._z,{children:[te,(0,v.jsx)(g.Z,{headerTitle:D==null?void 0:D.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:m,rowKey:"id",toolBarRender:function(){return[(0,v.jsxs)(v.Fragment,{children:[" ",(0,v.jsx)(fe,{trigger:(0,v.jsx)(u.ZP,{type:"primary",disabled:!ce(),children:" \u65B0 \u5EFA "}),id:de,onOk:Pe})]})]},request:i.Md,columns:ge,rowSelection:{onChange:function(o,l){_(l)}}})]})}},51876:function(pe,W,e){e.d(W,{FO:function(){return k},IV:function(){return d},Md:function(){return C},Vx:function(){return T},ah:function(){return v}});var H=e(97857),c=e.n(H),J=e(15009),s=e.n(J),z=e(99289),b=e.n(z),a=e(12578);function C(h,g,r){return M.apply(this,arguments)}function M(){return M=b()(s()().mark(function h(g,r,t){var u;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/role/page.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"GET",params:{params:g,sort:r,filter:t}}));case 2:case"end":return n.stop()}},h)})),M.apply(this,arguments)}function T(h){return w.apply(this,arguments)}function w(){return w=b()(s()().mark(function h(g){var r;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r="/staff/web/userCenter/auth/role/update.json",u.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(r,{method:"POST",data:g}));case 2:case"end":return u.stop()}},h)})),w.apply(this,arguments)}function k(h){return i.apply(this,arguments)}function i(){return i=b()(s()().mark(function h(g){var r;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r="/staff/web/userCenter/auth/role/getById.json",u.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(r,{method:"GET",params:{id:g}}));case 2:case"end":return u.stop()}},h)})),i.apply(this,arguments)}function d(h){return B.apply(this,arguments)}function B(){return B=b()(s()().mark(function h(g){var r;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r="/staff/web/userCenter/auth/role/del.json",u.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(r,{method:"POST",data:c()({},g)}));case 2:case"end":return u.stop()}},h)})),B.apply(this,arguments)}function v(){return K.apply(this,arguments)}function K(){return K=b()(s()().mark(function h(){var g;return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g="/staff/web/userCenter/auth/role/page.json",t.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(g,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return t.stop()}},h)})),K.apply(this,arguments)}},24982:function(pe,W,e){e.d(W,{FO:function(){return d},IV:function(){return h},J$:function(){return v},Md:function(){return C},Vx:function(){return T},pt:function(){return k}});var H=e(97857),c=e.n(H),J=e(15009),s=e.n(J),z=e(99289),b=e.n(z),a=e(12578);function C(r,t,u){return M.apply(this,arguments)}function M(){return M=b()(s()().mark(function r(t,u,I){var n;return s()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return n="/staff/web/userCenter/auth/user/page.json",X.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(n,{method:"GET",params:{params:t,sort:u,filter:I}}));case 2:case"end":return X.stop()}},r)})),M.apply(this,arguments)}function T(r){return w.apply(this,arguments)}function w(){return w=b()(s()().mark(function r(t){var u;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/update.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"POST",data:t}));case 2:case"end":return n.stop()}},r)})),w.apply(this,arguments)}function k(r){return i.apply(this,arguments)}function i(){return i=b()(s()().mark(function r(t){var u;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/updatePwd.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"POST",data:t}));case 2:case"end":return n.stop()}},r)})),i.apply(this,arguments)}function d(r){return B.apply(this,arguments)}function B(){return B=b()(s()().mark(function r(t){var u;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/getById.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"GET",params:{id:t}}));case 2:case"end":return n.stop()}},r)})),B.apply(this,arguments)}function v(r){return K.apply(this,arguments)}function K(){return K=b()(s()().mark(function r(t){var u;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/resetPwd.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"GET",params:{id:t}}));case 2:case"end":return n.stop()}},r)})),K.apply(this,arguments)}function h(r){return g.apply(this,arguments)}function g(){return g=b()(s()().mark(function r(t){var u;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/del.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"POST",data:c()({},t)}));case 2:case"end":return n.stop()}},r)})),g.apply(this,arguments)}},19515:function(pe,W,e){e.d(W,{P:function(){return C},V:function(){return a}});var H=e(64599),c=e.n(H),J=e(19632),s=e.n(J),z=e(27484),b=e.n(z);function a(){var M=b()().format("YYYYMMDDHHmmssSSS").toString();return M}function C(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],T=s()(M),w=c()(T),k;try{for(w.s();!(k=w.n()).done;){var i=k.value;!(i!=null&&i.valueType)||(i==null?void 0:i.valueType)!=="group"||!(i!=null&&i.columns)||!(i!=null&&i.columns.length)||T.push.apply(T,s()(i==null?void 0:i.columns))}}catch(d){w.e(d)}finally{w.f()}return T.filter(function(d){return d.valueType!=="group"})}}}]);
