"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[509],{21717:function(ne,I,e){e.r(I),e.d(I,{default:function(){return ie}});var V=e(15009),s=e.n(V),w=e(99289),p=e.n(w),U=e(19632),K=e.n(U),G=e(5574),_=e.n(G),M=e(97857),E=e.n(M),R=e(37476),b=e(26855),u=e(2453),r=e(12578);function ue(t,a,d){return L.apply(this,arguments)}function L(){return L=p()(s()().mark(function t(a,d,c){var n;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n="/staff/web/userCenter/promotion/use/page.json",i.abrupt("return",r.request===null||r.request===void 0?void 0:(0,r.request)(n,{method:"GET",params:{params:a,sort:d,filter:c}}));case 2:case"end":return i.stop()}},t)})),L.apply(this,arguments)}function te(t){return W.apply(this,arguments)}function W(){return W=p()(s()().mark(function t(a){var d;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d="/staff/web/userCenter/promotion/use/update.json",n.abrupt("return",r.request===null||r.request===void 0?void 0:(0,r.request)(d,{method:"POST",data:a}));case 2:case"end":return n.stop()}},t)})),W.apply(this,arguments)}function ae(t){return x.apply(this,arguments)}function x(){return x=p()(s()().mark(function t(a){var d;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d="/staff/web/userCenter/promotion/use/getById.json",n.abrupt("return",r.request===null||r.request===void 0?void 0:(0,r.request)(d,{method:"GET",params:{id:a}}));case 2:case"end":return n.stop()}},t)})),x.apply(this,arguments)}function se(t){return H.apply(this,arguments)}function H(){return H=p()(s()().mark(function t(a){var d;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d="/staff/web/userCenter/promotion/use/del.json",n.abrupt("return",r.request===null||r.request===void 0?void 0:(0,r.request)(d,{method:"POST",data:E()({},a)}));case 2:case"end":return n.stop()}},t)})),H.apply(this,arguments)}function pe(){return Y.apply(this,arguments)}function Y(){return Y=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var a;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a="/staff/web/userCenter/promotion/use/page.json",c.abrupt("return",request==null?void 0:request(a,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return c.stop()}},t)})),Y.apply(this,arguments)}var h=e(67294),X=[{valueType:"group",columns:[{title:"\u540D \u79F0",dataIndex:"name",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]}],f=e(85893),q=function(t){var a=(0,h.useRef)(),d=function(){var j=p()(s()().mark(function S(){var m;return s()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!n){v.next=7;break}return v.next=3,ae(n);case 3:if(m=v.sent,!m.data){v.next=6;break}return v.abrupt("return",a.current.setFieldsValue(E()({},m.data)));case 6:return v.abrupt("return",a.current.setFieldsValue({id:n}));case 7:case"end":return v.stop()}},S)}));return function(){return j.apply(this,arguments)}}(),c={id:"",title:""},n=t.id,O=t.trigger,i=t.onOk,A=(0,r.useRequest)(te,{manual:!0,onSuccess:function(){u.ZP.success("\u63D0\u4EA4\u6210\u529F"),i()},onError:function(){u.ZP.error("\u63D0\u4EA4\u5931\u8D25, \u8BF7\u91CD\u8BD5!")}}),Z=A.run,$=A.loading,T=function(){var j=p()(s()().mark(function S(m){return s()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return m=E()(E()({},m),{},{id:n}),Z(m),v.abrupt("return",!0);case 3:case"end":return v.stop()}},S)}));return function(m){return j.apply(this,arguments)}}();return(0,f.jsx)(R.Y,{formRef:a,onFinish:T,modalProps:{destroyOnClose:!0,okButtonProps:{loading:$}},onOpenChange:d,initialValues:c,title:"\u7F16\u8F91\u4FE1\u606F",trigger:O,children:(0,f.jsx)(b.Z,{layoutType:"Embed",columns:X})})},le=e(97131),oe=e(30077),k=e(14726),F=e(28248),P=e(19515),ie=function(){var t,a,d=(0,h.useState)(""),c=_()(d,2),n=c[0],O=c[1],i=(t=h.useRef)===null||t===void 0?void 0:t(),A=h.useState===null||h.useState===void 0?void 0:(0,h.useState)([]),Z=_()(A,2),$=Z[0],T=Z[1],j=r.useIntl===null||r.useIntl===void 0?void 0:(0,r.useIntl)(),S=u.ZP===null||u.ZP===void 0||(a=u.ZP.useMessage)===null||a===void 0?void 0:a.call(u.ZP),m=_()(S,2),y=m[0],v=m[1],ee=r.useRequest===null||r.useRequest===void 0?void 0:(0,r.useRequest)(se,{manual:!0,onSuccess:function(){var l,o,g;T==null||T([]),i==null||(l=i.current)===null||l===void 0||(o=l.reload)===null||o===void 0||o.call(l),y==null||(g=y.success)===null||g===void 0||g.call(y,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var l;y==null||(l=y.error)===null||l===void 0||l.call(y,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),D=ee.run,me=ee.loading,de=[].concat(K()(P.P===null||P.P===void 0?void 0:(0,P.P)(X)),[{title:(0,f.jsx)(r.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(l,o){var g;return[(0,f.jsx)(q,{trigger:(0,f.jsx)(k.ZP,{children:"\u7F16 \u8F91"}),id:o==null?void 0:o.id,onOk:i==null||(g=i.current)===null||g===void 0?void 0:g.reload},o.id)]}}]),ve=(0,h.useCallback)(function(){var C=p()(s()().mark(function l(o){var g;return s()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:F.Z===null||F.Z===void 0||(g=F.Z.confirm)===null||g===void 0||g.call(F.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8FD9"+(o==null?void 0:o.length)+"\u9879\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D",onOk:function(){var N;(N=function(){var fe=p()(s()().mark(function re(){var J;return s()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,D==null?void 0:D(o==null||(J=o.map)===null||J===void 0?void 0:J.call(o,function(Q){return Q==null?void 0:Q.id}));case 2:case"end":return B.stop()}},re)}));return function(){return fe.apply(this,arguments)}}())===null||N===void 0||N()}});case 1:case"end":return z.stop()}},l)}));return function(l){return C.apply(this,arguments)}}(),[D]),ce=function(){var l;O==null||O(P.V===null||P.V===void 0?void 0:(0,P.V)()),i==null||(l=i.current)===null||l===void 0||l.reload()};return h.useEffect===null||h.useEffect===void 0||(0,h.useEffect)(function(){O==null||O(P.V===null||P.V===void 0?void 0:(0,P.V)())},[]),(0,f.jsxs)(le._z,{children:[v,(0,f.jsx)(oe.Z,{headerTitle:j==null?void 0:j.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:i,rowKey:"id",toolBarRender:function(){return[(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(k.ZP,{danger:!0,disabled:!$||!$.length,onClick:function(){ve($)},children:"\u5220 \u9664"}),(0,f.jsx)(q,{trigger:(0,f.jsx)(k.ZP,{type:"primary",children:" \u65B0 \u5EFA "}),id:n,onOk:ce})]})]},request:ue,columns:de,rowSelection:{onChange:function(l,o){T(o)}}})]})}},19515:function(ne,I,e){e.d(I,{P:function(){return _},V:function(){return G}});var V=e(64599),s=e.n(V),w=e(19632),p=e.n(w),U=e(27484),K=e.n(U);function G(){var M=K()().format("YYYYMMDDHHmmssSSS").toString();return M}function _(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=p()(M),R=s()(E),b;try{for(R.s();!(b=R.n()).done;){var u=b.value;!(u!=null&&u.valueType)||(u==null?void 0:u.valueType)!=="group"||!(u!=null&&u.columns)||!(u!=null&&u.columns.length)||E.push.apply(E,p()(u==null?void 0:u.columns))}}catch(r){R.e(r)}finally{R.f()}return E.filter(function(r){return r.valueType!=="group"})}}}]);
