"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[940],{51565:function(ue,A,e){e.r(A),e.d(A,{default:function(){return de}});var w=e(15009),s=e.n(w),U=e(99289),m=e.n(U),K=e(19632),L=e.n(K),G=e(5574),_=e.n(G),b=e(97857),E=e.n(b),M=e(37476),D=e(26855),r=e(2453),n=e(12578);function te(a,l,c){return W.apply(this,arguments)}function W(){return W=m()(s()().mark(function a(l,c,f){var u;return s()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return u="/staff/web/userCenter/promotion/coupon/page.json",d.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(u,{method:"GET",params:{params:l,sort:c,filter:f}}));case 2:case"end":return d.stop()}},a)})),W.apply(this,arguments)}function k(a){return H.apply(this,arguments)}function H(){return H=m()(s()().mark(function a(l){var c;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return c="/staff/web/userCenter/promotion/coupon/update.json",u.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(c,{method:"POST",data:l}));case 2:case"end":return u.stop()}},a)})),H.apply(this,arguments)}function le(a){return Y.apply(this,arguments)}function Y(){return Y=m()(s()().mark(function a(l){var c;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return c="/staff/web/userCenter/promotion/coupon/getById.json",u.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(c,{method:"GET",params:{id:l}}));case 2:case"end":return u.stop()}},a)})),Y.apply(this,arguments)}function se(a){return x.apply(this,arguments)}function x(){return x=m()(s()().mark(function a(l){var c;return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return c="/staff/web/userCenter/promotion/coupon/del.json",u.abrupt("return",n.request===null||n.request===void 0?void 0:(0,n.request)(c,{method:"POST",data:E()({},l)}));case 2:case"end":return u.stop()}},a)})),x.apply(this,arguments)}function me(){return z.apply(this,arguments)}function z(){return z=_asyncToGenerator(_regeneratorRuntime().mark(function a(){var l;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return l="/staff/web/userCenter/promotion/coupon/page.json",f.abrupt("return",request==null?void 0:request(l,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return f.stop()}},a)})),z.apply(this,arguments)}var g=e(67294),re=[{valueType:"group",columns:[{title:"\u540D \u79F0",dataIndex:"name",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]}],p=e(85893),ne=function(a){var l=(0,g.useRef)(),c=(0,g.useState)(!1),f=_()(c,2),u=f[0],h=f[1],d=function(){var F=m()(s()().mark(function j(){var v;return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!T){t.next=7;break}return t.next=3,le(T);case 3:if(v=t.sent,!v.data){t.next=6;break}return t.abrupt("return",l.current.setFieldsValue(E()({},v.data)));case 6:return t.abrupt("return",l.current.setFieldsValue({id:T}));case 7:case"end":return t.stop()}},j)}));return function(){return F.apply(this,arguments)}}(),J={id:"",title:""},T=a.id,Z=a.trigger,S=a.onOk,I=function(){var F=m()(s()().mark(function j(v){var $,t,C;return s()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return h(!0),v=E()(E()({},v),{},{id:T}),P.next=4,k==null?void 0:k(v);case 4:if(t=P.sent,(t==null?void 0:t.code)===0){P.next=9;break}return r.ZP===null||r.ZP===void 0||(C=r.ZP.error)===null||C===void 0||C.call(r.ZP,t==null?void 0:t.message),h(!1),P.abrupt("return",!1);case 9:return r.ZP===null||r.ZP===void 0||($=r.ZP.success)===null||$===void 0||$.call(r.ZP,"\u63D0\u4EA4\u6210\u529F"),S==null||S(),h(!1),P.abrupt("return",!0);case 13:case"end":return P.stop()}},j)}));return function(v){return F.apply(this,arguments)}}();return(0,p.jsx)(M.Y,{formRef:l,onFinish:I,modalProps:{destroyOnClose:!0,okButtonProps:{loading:u}},onOpenChange:d,initialValues:J,title:"\u7F16\u8F91\u4FE1\u606F",trigger:Z,children:(0,p.jsx)(D.Z,{layoutType:"Embed",columns:re})})},oe=e(97131),ie=e(30077),N=e(14726),B=e(28248),O=e(19515),de=function(){var a,l,c=(0,g.useState)(""),f=_()(c,2),u=f[0],h=f[1],d=(a=g.useRef)===null||a===void 0?void 0:a(),J=g.useState===null||g.useState===void 0?void 0:(0,g.useState)([]),T=_()(J,2),Z=T[0],S=T[1],I=n.useIntl===null||n.useIntl===void 0?void 0:(0,n.useIntl)(),F=r.ZP===null||r.ZP===void 0||(l=r.ZP.useMessage)===null||l===void 0?void 0:l.call(r.ZP),j=_()(F,2),v=j[0],$=j[1],t=n.useRequest===null||n.useRequest===void 0?void 0:(0,n.useRequest)(se,{manual:!0,onSuccess:function(){var o,i,y;S==null||S([]),d==null||(o=d.current)===null||o===void 0||(i=o.reload)===null||i===void 0||i.call(o),v==null||(y=v.success)===null||y===void 0||y.call(v,"\u5220\u9664\u64CD\u4F5C\u6210\u529F")},onError:function(){var o;v==null||(o=v.error)===null||o===void 0||o.call(v,"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5")}}),C=t.run,ve=t.loading,P=[].concat(L()(O.P===null||O.P===void 0?void 0:(0,O.P)(re)),[{title:(0,p.jsx)(n.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(o,i){var y;return[(0,p.jsx)(ne,{trigger:(0,p.jsx)(N.ZP,{children:"\u7F16 \u8F91"}),id:i==null?void 0:i.id,onOk:d==null||(y=d.current)===null||y===void 0?void 0:y.reload},i.id)]}}]),ce=(0,g.useCallback)(function(){var R=m()(s()().mark(function o(i){var y;return s()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:B.Z===null||B.Z===void 0||(y=B.Z.confirm)===null||y===void 0||y.call(B.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8FD9"+(i==null?void 0:i.length)+"\u9879\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D",onOk:function(){var X;(X=function(){var pe=m()(s()().mark(function ae(){var q;return s()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,C==null?void 0:C(i==null||(q=i.map)===null||q===void 0?void 0:q.call(i,function(ee){return ee==null?void 0:ee.id}));case 2:case"end":return V.stop()}},ae)}));return function(){return pe.apply(this,arguments)}}())===null||X===void 0||X()}});case 1:case"end":return Q.stop()}},o)}));return function(o){return R.apply(this,arguments)}}(),[C]),fe=function(){var o;h==null||h(O.V===null||O.V===void 0?void 0:(0,O.V)()),d==null||(o=d.current)===null||o===void 0||o.reload()};return g.useEffect===null||g.useEffect===void 0||(0,g.useEffect)(function(){h==null||h(O.V===null||O.V===void 0?void 0:(0,O.V)())},[]),(0,p.jsxs)(oe._z,{children:[$,(0,p.jsx)(ie.Z,{headerTitle:I==null?void 0:I.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:d,rowKey:"id",toolBarRender:function(){return[(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(N.ZP,{danger:!0,disabled:!Z||!Z.length,onClick:function(){ce(Z)},children:"\u5220 \u9664"}),(0,p.jsx)(ne,{trigger:(0,p.jsx)(N.ZP,{type:"primary",children:" \u65B0 \u5EFA "}),id:u,onOk:fe})]})]},request:te,columns:P,rowSelection:{onChange:function(o,i){S(i)}}})]})}},19515:function(ue,A,e){e.d(A,{P:function(){return _},V:function(){return G}});var w=e(64599),s=e.n(w),U=e(19632),m=e.n(U),K=e(27484),L=e.n(K);function G(){var b=L()().format("YYYYMMDDHHmmssSSS").toString();return b}function _(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=m()(b),M=s()(E),D;try{for(M.s();!(D=M.n()).done;){var r=D.value;!(r!=null&&r.valueType)||(r==null?void 0:r.valueType)!=="group"||!(r!=null&&r.columns)||!(r!=null&&r.columns.length)||E.push.apply(E,m()(r==null?void 0:r.columns))}}catch(n){M.e(n)}finally{M.f()}return E.filter(function(n){return n.valueType!=="group"})}}}]);
