"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[355],{25171:function(he,G,e){e.r(G),e.d(G,{default:function(){return te}});var J=e(15009),_=e.n(J),z=e(99289),t=e.n(z),N=e(19632),b=e.n(N),a=e(5574),I=e.n(a),R=e(97857),T=e.n(R),j=e(37476),L=e(26855),r=e(2453),v=e(24982),m=e(67294),Q=e(51876),c=e(85893),E=function(A){var B,de=(0,m.useState)({}),x=I()(de,2),me=x[0],pe=x[1],Z=(B=m.useRef)===null||B===void 0?void 0:B(),X=(0,m.useState)(!1),H=I()(X,2),le=H[0],p=H[1],ve=r.ZP.useMessage(),se=I()(ve,2),V=se[0],ie=se[1],q=function(){var f=t()(_()().mark(function w(){var g,i,M,re,o,oe,ce;return _()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,Q.ah)();case 2:if(g=S.sent,i=g.data,console.log(i),pe(i),!P){S.next=13;break}return S.next=9,v.FO===null||v.FO===void 0?void 0:(0,v.FO)(P);case 9:if(o=S.sent,!(o!=null&&o.data)){S.next=12;break}return S.abrupt("return",Z==null||(oe=Z.current)===null||oe===void 0||(ce=oe.setFieldsValue)===null||ce===void 0?void 0:ce.call(oe,T()({},o==null?void 0:o.data)));case 12:return S.abrupt("return",Z==null||(M=Z.current)===null||M===void 0||(re=M.setFieldsValue)===null||re===void 0?void 0:re.call(M,{id:P}));case 13:case"end":return S.stop()}},w)}));return function(){return f.apply(this,arguments)}}(),Y={id:"",title:""},P=A.id,ee=A.trigger,D=A.onOk,U=[{valueType:"group",columns:[{title:"\u7528\u6237\u540D",dataIndex:"username",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]},{valueType:"group",columns:[{title:"\u89D2 \u8272",dataIndex:"roleIds",sorter:!0,valueType:"select",hideInTable:!0,hideInSearch:!0,mode:"multiple",formItemProps:{mode:"multiple"},fieldProps:{mode:"multiple"},valueEnum:me}]}],C=function(){var f=t()(_()().mark(function w(g){var i,M;return _()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return p==null||p(!0),g=T()(T()({},g),{},{id:P}),o.next=4,v.Vx===null||v.Vx===void 0?void 0:(0,v.Vx)(g);case 4:if(i=o.sent,(i==null?void 0:i.code)===0){o.next=10;break}return p==null||p(!1),o.abrupt("return",!1);case 10:return V==null||(M=V.success)===null||M===void 0||M.call(V,"\u63D0\u4EA4\u6210\u529F"),D==null||D(),p==null||p(!1),o.abrupt("return",!0);case 14:case"end":return o.stop()}},w)}));return function(g){return f.apply(this,arguments)}}();return(0,c.jsxs)(c.Fragment,{children:[ie,(0,c.jsx)(j.Y,{formRef:Z,onFinish:C,modalProps:{destroyOnClose:!0,okButtonProps:{loading:le}},onOpenChange:q,initialValues:Y,title:"\u7F16\u8F91\u4FE1\u606F",trigger:ee,children:(0,c.jsx)(L.Z,{layoutType:"Embed",columns:U})})]})},y=e(97131),s=e(30077),d=e(12578),u=e(14726),O=e(28248),n=e(19515),Pe=function(A){var B,de=(0,m.useState)({}),x=I()(de,2),me=x[0],pe=x[1],Z=(0,m.useState)(!1),X=I()(Z,2),H=X[0],le=X[1],p=(B=m.useRef)===null||B===void 0?void 0:B(),ve=function(){var ee=t()(_()().mark(function D(){var U,C,f,w,g,i,M;return _()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,Q.ah)();case 2:if(U=o.sent,C=U.data,console.log(C),pe(C),!V){o.next=13;break}return o.next=9,v.FO===null||v.FO===void 0?void 0:(0,v.FO)(V);case 9:if(g=o.sent,!(g!=null&&g.data)){o.next=12;break}return o.abrupt("return",p==null||(i=p.current)===null||i===void 0||(M=i.setFieldsValue)===null||M===void 0?void 0:M.call(i,T()({},g==null?void 0:g.data)));case 12:return o.abrupt("return",p==null||(f=p.current)===null||f===void 0||(w=f.setFieldsValue)===null||w===void 0?void 0:w.call(f,{id:V}));case 13:case"end":return o.stop()}},D)}));return function(){return ee.apply(this,arguments)}}(),se={id:"",title:""},V=A.id,ie=A.trigger,q=A.onOk,Y=[{valueType:"group",columns:[{title:"\u7528\u6237\u540D",dataIndex:"username",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]},{valueType:"group",columns:[{title:"\u5BC6 \u7801",dataIndex:"password",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"},{title:"\u786E\u8BA4\u5BC6\u7801",dataIndex:"confirmPassword",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"}]},{valueType:"group",columns:[{title:"\u89D2 \u8272",dataIndex:"roleIds",sorter:!0,valueType:"select",hideInTable:!0,hideInSearch:!0,mode:"multiple",formItemProps:{mode:"multiple"},fieldProps:{mode:"multiple"},valueEnum:me}]}],P=function(){var ee=t()(_()().mark(function D(U){var C,f,w;return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return U=T()(T()({},U),{},{id:V}),i.next=3,v.Vx===null||v.Vx===void 0?void 0:(0,v.Vx)(U);case 3:if(f=i.sent,(f==null?void 0:f.code)===0){i.next=8;break}return r.ZP===null||r.ZP===void 0||(w=r.ZP.error)===null||w===void 0||w.call(r.ZP,f==null?void 0:f.message),le(!1),i.abrupt("return",!1);case 8:return r.ZP===null||r.ZP===void 0||(C=r.ZP.success)===null||C===void 0||C.call(r.ZP,"\u63D0\u4EA4\u6210\u529F"),q==null||q(),le(!1),i.abrupt("return",!0);case 12:case"end":return i.stop()}},D)}));return function(U){return ee.apply(this,arguments)}}();return(0,c.jsx)(j.Y,{formRef:p,onFinish:P,modalProps:{destroyOnClose:!0,okButtonProps:{loading:H}},onOpenChange:ve,initialValues:se,title:"\u7F16\u8F91\u4FE1\u606F",trigger:ie,children:(0,c.jsx)(L.Z,{layoutType:"Embed",columns:Y})})},te=function(){var A,B,de=(0,m.useState)(""),x=I()(de,2),me=x[0],pe=x[1],Z=(0,d.useModel)("@@initialState"),X=Z.initialState.currentUser,H=X===void 0?{}:X,le=(0,m.useState)({}),p=I()(le,2),ve=p[0],se=p[1],V=(0,m.useState)(""),ie=I()(V,2),q=ie[0],Y=ie[1],P=(A=m.useRef)===null||A===void 0?void 0:A(),ee=m.useState===null||m.useState===void 0?void 0:(0,m.useState)([]),D=I()(ee,2),U=D[0],C=D[1],f=d.useIntl===null||d.useIntl===void 0?void 0:(0,d.useIntl)(),w=r.ZP===null||r.ZP===void 0||(B=r.ZP.useMessage)===null||B===void 0?void 0:B.call(r.ZP),g=I()(w,2),i=g[0],M=g[1],re=[{valueType:"group",columns:[{title:"\u7528\u6237\u540D",dataIndex:"username",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]}}]},{valueType:"group",columns:[{title:"\u5BC6 \u7801",dataIndex:"password",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"},{title:"\u786E\u8BA4\u5BC6\u7801",dataIndex:"confirmPassword",sorter:!0,hideInTable:!0,hideInSearch:!0,valueType:"password"}]},{valueType:"group",columns:[{title:"\u89D2 \u8272",dataIndex:"roleIds",sorter:!0,valueType:"select",hideInTable:!0,hideInSearch:!0,formItemProps:{mode:"multiple"},valueEnum:ve}]}],o=[].concat(b()(n.P===null||n.P===void 0?void 0:(0,n.P)(re)),[{title:(0,c.jsx)(d.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(h,l){var F;return[(0,c.jsx)(E,{trigger:(0,c.jsx)(u.ZP,{type:"primary",disabled:(l==null?void 0:l.username)==="admin"||!S(),children:"\u7F16 \u8F91"}),id:l==null?void 0:l.id,onOk:P==null||(F=P.current)===null||F===void 0?void 0:F.reload},l==null?void 0:l.id),(0,c.jsx)(u.ZP,{disabled:(l==null?void 0:l.username)==="admin"||!S(),onClick:function(){ce(l)},children:"\u5BC6\u7801\u91CD\u7F6E"}),(0,c.jsx)(u.ZP,{danger:!0,onClick:function(){oe(l)},disabled:(l==null?void 0:l.username)==="admin"||!S(),children:"\u5220 \u9664"})]}}]),oe=function(){var k=t()(_()().mark(function h(l){var F;return _()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:O.Z===null||O.Z===void 0||(F=O.Z.confirm)===null||F===void 0||F.call(O.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u7528\u6237\u540D\u4E3A".concat(l.username,"\u7684\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D"),onOk:function(){var ne;(ne=function(){var _e=t()(_()().mark(function fe(){var $,ge,W,Ee,ye;return _()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,v.IV===null||v.IV===void 0?void 0:(0,v.IV)([l==null?void 0:l.id]);case 2:if($=ae.sent,($==null?void 0:$.code)===0){ae.next=7;break}return ae.abrupt("return",i==null||(ge=i.error)===null||ge===void 0?void 0:ge.call(i,($==null?void 0:$.message)||"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5"));case 7:C==null||C([]),P==null||(W=P.current)===null||W===void 0||(Ee=W.reload)===null||Ee===void 0||Ee.call(W),i==null||(ye=i.success)===null||ye===void 0||ye.call(i,($==null?void 0:$.message)||"\u5220\u9664\u64CD\u4F5C\u6210\u529F");case 10:case"end":return ae.stop()}},fe)}));return function(){return _e.apply(this,arguments)}}())===null||ne===void 0||ne()}});case 1:case"end":return ue.stop()}},h)}));return function(l){return k.apply(this,arguments)}}(),ce=function(){var k=t()(_()().mark(function h(l){var F;return _()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:O.Z===null||O.Z===void 0||(F=O.Z.confirm)===null||F===void 0||F.call(O.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u91CD\u7F6E\u7528\u6237\u540D\u4E3A".concat(l.username,"\u7684\u5BC6\u7801?\u91CD\u7F6E\u540E\u6B64\u7528\u6237\u5BC6\u7801\u5C06\u4E3A\u521D\u59CB\u5BC6\u7801aaaa1111"),onOk:function(){var ne,_e;(ne=function(){var fe=t()(_()().mark(function $(){return _()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,v.J$===null||v.J$===void 0?void 0:(0,v.J$)(l==null?void 0:l.id);case 2:case"end":return W.stop()}},$)}));return function(){return fe.apply(this,arguments)}}())===null||ne===void 0||ne(),r.ZP===null||r.ZP===void 0||(_e=r.ZP.success)===null||_e===void 0||_e.call(r.ZP,"\u63D0\u4EA4\u6210\u529F")}});case 1:case"end":return ue.stop()}},h)}));return function(l){return k.apply(this,arguments)}}(),be=function(){var h;Y==null||Y(n.V===null||n.V===void 0?void 0:(0,n.V)()),P==null||(h=P.current)===null||h===void 0||h.reload()},S=function(){var h;return H!=null&&(h=H.roleIds)!==null&&h!==void 0&&h.includes("1")?(console.log("isAdmin"),!0):!1};return m.useEffect===null||m.useEffect===void 0||(0,m.useEffect)(function(){Y((0,n.V)()),t()(_()().mark(function k(){var h,l;return _()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,Q.ah)();case 2:h=K.sent,l=h.data,console.log(l),se(l);case 6:case"end":return K.stop()}},k)}))()},[]),(0,c.jsxs)(y._z,{children:[M,(0,c.jsx)(s.Z,{headerTitle:f==null?void 0:f.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:P,rowKey:"id",toolBarRender:function(){return[(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(Pe,{trigger:(0,c.jsxs)(u.ZP,{type:"primary",disabled:!S(),children:[" ","\u65B0 \u5EFA"," "]}),id:q,onOk:be})]})]},request:v.Md,columns:o,rowSelection:{onChange:function(h,l){C(l)}}})]})}},51876:function(he,G,e){e.d(G,{FO:function(){return L},IV:function(){return v},Md:function(){return I},Vx:function(){return T},ah:function(){return Q}});var J=e(97857),_=e.n(J),z=e(15009),t=e.n(z),N=e(99289),b=e.n(N),a=e(12578);function I(E,y,s){return R.apply(this,arguments)}function R(){return R=b()(t()().mark(function E(y,s,d){var u;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/role/page.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"GET",params:{params:y,sort:s,filter:d}}));case 2:case"end":return n.stop()}},E)})),R.apply(this,arguments)}function T(E){return j.apply(this,arguments)}function j(){return j=b()(t()().mark(function E(y){var s;return t()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s="/staff/web/userCenter/auth/role/update.json",u.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(s,{method:"POST",data:y}));case 2:case"end":return u.stop()}},E)})),j.apply(this,arguments)}function L(E){return r.apply(this,arguments)}function r(){return r=b()(t()().mark(function E(y){var s;return t()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s="/staff/web/userCenter/auth/role/getById.json",u.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(s,{method:"GET",params:{id:y}}));case 2:case"end":return u.stop()}},E)})),r.apply(this,arguments)}function v(E){return m.apply(this,arguments)}function m(){return m=b()(t()().mark(function E(y){var s;return t()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s="/staff/web/userCenter/auth/role/del.json",u.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(s,{method:"POST",data:_()({},y)}));case 2:case"end":return u.stop()}},E)})),m.apply(this,arguments)}function Q(){return c.apply(this,arguments)}function c(){return c=b()(t()().mark(function E(){var y;return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return y="/staff/web/userCenter/auth/role/page.json",d.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(y,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return d.stop()}},E)})),c.apply(this,arguments)}},24982:function(he,G,e){e.d(G,{FO:function(){return v},IV:function(){return E},J$:function(){return Q},Md:function(){return I},Vx:function(){return T},pt:function(){return L}});var J=e(97857),_=e.n(J),z=e(15009),t=e.n(z),N=e(99289),b=e.n(N),a=e(12578);function I(s,d,u){return R.apply(this,arguments)}function R(){return R=b()(t()().mark(function s(d,u,O){var n;return t()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return n="/staff/web/userCenter/auth/user/page.json",te.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(n,{method:"GET",params:{params:d,sort:u,filter:O}}));case 2:case"end":return te.stop()}},s)})),R.apply(this,arguments)}function T(s){return j.apply(this,arguments)}function j(){return j=b()(t()().mark(function s(d){var u;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/update.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"POST",data:d}));case 2:case"end":return n.stop()}},s)})),j.apply(this,arguments)}function L(s){return r.apply(this,arguments)}function r(){return r=b()(t()().mark(function s(d){var u;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/updatePwd.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"POST",data:d}));case 2:case"end":return n.stop()}},s)})),r.apply(this,arguments)}function v(s){return m.apply(this,arguments)}function m(){return m=b()(t()().mark(function s(d){var u;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/getById.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"GET",params:{id:d}}));case 2:case"end":return n.stop()}},s)})),m.apply(this,arguments)}function Q(s){return c.apply(this,arguments)}function c(){return c=b()(t()().mark(function s(d){var u;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/resetPwd.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"GET",params:{id:d}}));case 2:case"end":return n.stop()}},s)})),c.apply(this,arguments)}function E(s){return y.apply(this,arguments)}function y(){return y=b()(t()().mark(function s(d){var u;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u="/staff/web/userCenter/auth/user/del.json",n.abrupt("return",a.request===null||a.request===void 0?void 0:(0,a.request)(u,{method:"POST",data:_()({},d)}));case 2:case"end":return n.stop()}},s)})),y.apply(this,arguments)}},19515:function(he,G,e){e.d(G,{P:function(){return I},V:function(){return a}});var J=e(64599),_=e.n(J),z=e(19632),t=e.n(z),N=e(27484),b=e.n(N);function a(){var R=b()().format("YYYYMMDDHHmmssSSS").toString();return R}function I(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],T=t()(R),j=_()(T),L;try{for(j.s();!(L=j.n()).done;){var r=L.value;!(r!=null&&r.valueType)||(r==null?void 0:r.valueType)!=="group"||!(r!=null&&r.columns)||!(r!=null&&r.columns.length)||T.push.apply(T,t()(r==null?void 0:r.columns))}}catch(v){j.e(v)}finally{j.f()}return T.filter(function(v){return v.valueType!=="group"})}}}]);
