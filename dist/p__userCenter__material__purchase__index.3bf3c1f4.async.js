"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[428],{60419:function(Te,pe,t){t.r(pe),t.d(pe,{default:function(){return vr}});var he=t(15009),_=t.n(he),ge=t(99289),b=t.n(ge),ye=t(5574),Y=t.n(ye),M=t(97857),te=t.n(M),le=t(37476),se=t(26855),ae=t(30077),G=t(2453),O=t(28248),X=t(14726),g=t(6493),h=t(67294),_e=[{valueType:"group",columns:[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},width:"m"}]}],oe=t(12578);function fe(e,d,o){return Ie.apply(this,arguments)}function Ie(){return Ie=b()(_()().mark(function e(d,o,E){var u;return _()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return u="/staff/web/userCenter/purchase/material/page.json",T.abrupt("return",oe.request===null||oe.request===void 0?void 0:(0,oe.request)(u,{method:"GET",params:{params:d,sort:o,filter:E}}));case 2:case"end":return T.stop()}},e)})),Ie.apply(this,arguments)}function Oe(e){return we.apply(this,arguments)}function we(){return we=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o="/staff/web/userCenter/purchase/material/update.json",u.abrupt("return",request==null?void 0:request(o,{method:"POST",data:d}));case 2:case"end":return u.stop()}},e)})),we.apply(this,arguments)}function Pe(e){return be.apply(this,arguments)}function be(){return be=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o="/staff/web/userCenter/purchase/material/getById.json",u.abrupt("return",request==null?void 0:request(o,{method:"GET",params:{id:d}}));case 2:case"end":return u.stop()}},e)})),be.apply(this,arguments)}function Ce(e){return Se.apply(this,arguments)}function Se(){return Se=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o="/staff/web/userCenter/purchase/material/del.json",u.abrupt("return",request==null?void 0:request(o,{method:"POST",data:_objectSpread({},d)}));case 2:case"end":return u.stop()}},e)})),Se.apply(this,arguments)}function Ee(e,d,o,E){return w.apply(this,arguments)}function w(){return w=_asyncToGenerator(_regeneratorRuntime().mark(function e(d,o,E,u){var S;return _regeneratorRuntime().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return S="/staff/web/userCenter/purchase/materialItem/page.json?orderId="+d,J.abrupt("return",request==null?void 0:request(S,{method:"GET",params:{params:o,sort:E,filter:u}}));case 2:case"end":return J.stop()}},e)})),w.apply(this,arguments)}function k(e){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o="/staff/web/userCenter/purchase/material/updateItem.json",u.abrupt("return",request==null?void 0:request(o,{method:"POST",data:d}));case 2:case"end":return u.stop()}},e)})),C.apply(this,arguments)}function Q(e){return c.apply(this,arguments)}function c(){return c=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o="/staff/web/userCenter/purchase/material/submit.json?id="+d,u.abrupt("return",request==null?void 0:request(o,{method:"POST"}));case 2:case"end":return u.stop()}},e)})),c.apply(this,arguments)}function $e(e){return de.apply(this,arguments)}function de(){return de=_asyncToGenerator(_regeneratorRuntime().mark(function e(d){var o;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o="/staff/web/userCenter/inventory/inbill/purchaseInstock.json",u.abrupt("return",request==null?void 0:request(o,{method:"POST",data:d}));case 2:case"end":return u.stop()}},e)})),de.apply(this,arguments)}var n=t(85893),Ge=function(e){var d,o=(0,h.useState)({}),E=Y()(o,2),u=E[0],S=E[1],T=(d=h.useRef)===null||d===void 0?void 0:d(),J=function(){var l=b()(_()().mark(function R(){var j,i,V,m,re,ee;return _()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,fe==null?void 0:fe({},{},{});case 2:if(j=q.sent,S==null||S(j==null?void 0:j.data),!B){q.next=11;break}return q.next=7,g.FO===null||g.FO===void 0?void 0:(0,g.FO)(B);case 7:if(m=q.sent,!(m!=null&&m.data)){q.next=10;break}return q.abrupt("return",T==null||(re=T.current)===null||re===void 0||(ee=re.setFieldsValue)===null||ee===void 0?void 0:ee.call(re,te()({},m==null?void 0:m.data)));case 10:return q.abrupt("return",T==null||(i=T.current)===null||i===void 0||(V=i.setFieldsValue)===null||V===void 0?void 0:V.call(i,{id:B,orderId:z}));case 11:case"end":return q.stop()}},R)}));return function(){return l.apply(this,arguments)}}(),H={id:"",title:"",orderId:""},B=e.id,ie=e.trigger,ne=e.onOk,z=e.orderId,Z=function(){var l=b()(_()().mark(function R(j){var i;return _()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return j=te()(te()({},j),{},{id:B,orderId:z}),m.next=3,g.$G===null||g.$G===void 0?void 0:(0,g.$G)(j);case 3:return i=m.sent,m.abrupt("return",!0);case 5:case"end":return m.stop()}},R)}));return function(j){return l.apply(this,arguments)}}(),A={input:{text:"\u521B\u5EFA\u65B0\u7269\u6599"},radio:{text:"\u4ECE\u5DF2\u6709\u7269\u6599\u4E2D\u9009\u62E9"}},F=[{valueType:"group",columns:[{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0},{title:"\u91C7\u8D2D\u65B9\u5F0F",dataIndex:"type",sorter:!0,valueType:"select",valueEnum:A,formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u91C7\u8D2D\u65B9\u5F0F"}]},width:"m",hideInSearch:!0},{valueType:"dependency",name:["type"],columns:function(R){var j=R.type;return j==="input"?[{valueType:"group",columns:[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"name",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0},{title:"\u89C4 \u683C",dataIndex:"sku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m",hideInSearch:!0}]}]:j==="radio"?[{title:"\u7269\u6599\u540D\u79F0\u53CA\u89C4\u683C",dataIndex:"materialId",sorter:!0,valueType:"select",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7269\u6599\u540D\u79F0\u53CA\u89C4\u683C"}]},width:"m",hideInSearch:!0,valueEnum:u}]:[]}}]}];return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(le.Y,{formRef:T,onFinish:Z,modalProps:{destroyOnClose:!0,okButtonProps:{loading}},onOpenChange:J,initialValues:H,title:"\u7F16\u8F91\u91C7\u8D2D\u660E\u7EC6\u5355",trigger:ie,children:(0,n.jsx)(se.Z,{layoutType:"Embed",columns:F})})})},ve=t(19515),Ze=function(e){var d,o,E,u=(d=h.useRef)===null||d===void 0?void 0:d(),S=h.useState===null||h.useState===void 0?void 0:(0,h.useState)(!1),T=Y()(S,2),J=T[0],H=T[1],B=(o=h.useRef)===null||o===void 0?void 0:o(),ie=h.useState===null||h.useState===void 0?void 0:(0,h.useState)([]),ne=Y()(ie,2),z=ne[0],Z=ne[1],A=G.ZP===null||G.ZP===void 0||(E=G.ZP.useMessage)===null||E===void 0?void 0:E.call(G.ZP),F=Y()(A,2),l=F[0],R=F[1],j=function(){var W=b()(_()().mark(function y(){var r,$,U,P,ue,K;return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(B==null||(r=B.current)===null||r===void 0||r.reload(),!V){a.next=8;break}return a.next=4,g.FO===null||g.FO===void 0?void 0:(0,g.FO)(V);case 4:if(P=a.sent,!(P!=null&&P.data)){a.next=7;break}return a.abrupt("return",u==null||(ue=u.current)===null||ue===void 0||(K=ue.setFieldsValue)===null||K===void 0?void 0:K.call(ue,te()({},P==null?void 0:P.data)));case 7:return a.abrupt("return",u==null||($=u.current)===null||$===void 0||(U=$.setFieldsValue)===null||U===void 0?void 0:U.call($,{id:V,title:"\u91C7\u8D2D\u5355"+V}));case 8:case"end":return a.stop()}},y)}));return function(){return W.apply(this,arguments)}}(),i={id:"",title:""},V=e.id,m=e.trigger,re=e.onOk,ee=function(){var W=b()(_()().mark(function y(r){var $,U,P;return _()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return r=te()(te()({},r),{},{id:V}),K.next=3,g.Vx===null||g.Vx===void 0?void 0:(0,g.Vx)(r);case 3:if(U=K.sent,(U==null?void 0:U.code)===0){K.next=8;break}return G.ZP===null||G.ZP===void 0||(P=G.ZP.error)===null||P===void 0||P.call(G.ZP,U==null?void 0:U.message),H==null||H(!1),K.abrupt("return",!1);case 8:return G.ZP===null||G.ZP===void 0||($=G.ZP.success)===null||$===void 0||$.call(G.ZP,"\u63D0\u4EA4\u6210\u529F"),re==null||re(),H==null||H(!1),K.abrupt("return",!0);case 12:case"end":return K.stop()}},y)}));return function(r){return W.apply(this,arguments)}}(),me=function(){var W=b()(_()().mark(function y(r){var $;return _()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:O.Z===null||O.Z===void 0||($=O.Z.confirm)===null||$===void 0||$.call(O.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8FD9"+(r==null?void 0:r.length)+"\u9879\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D",onOk:function(){b()(_()().mark(function K(){var f,a,s,v,p,I;return _()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,g.IV===null||g.IV===void 0?void 0:(0,g.IV)(r==null||(f=r.map)===null||f===void 0?void 0:f.call(r,function(L){return L==null?void 0:L.id}));case 2:if(a=x.sent,(a==null?void 0:a.code)===0){x.next=7;break}return x.abrupt("return",l==null||(s=l.error)===null||s===void 0?void 0:s.call(l,(a==null?void 0:a.message)||"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5"));case 7:Z==null||Z([]),B==null||(v=B.current)===null||v===void 0||(p=v.reload)===null||p===void 0||p.call(v),l==null||(I=l.success)===null||I===void 0||I.call(l,(a==null?void 0:a.message)||"\u5220\u9664\u64CD\u4F5C\u6210\u529F");case 10:case"end":return x.stop()}},K)}))()}});case 1:case"end":return P.stop()}},y)}));return function(r){return W.apply(this,arguments)}}(),q=[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C4\u683C"}]},width:"m",hideInSearch:!0},{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0}],Re=function(){var y;B==null||(y=B.current)===null||y===void 0||y.reload()},ce=function(){var W=b()(_()().mark(function y(r){var $;return _()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,g.ZI===null||g.ZI===void 0?void 0:(0,g.ZI)(V,r,null,null);case 2:return $=P.sent,P.abrupt("return",$);case 4:case"end":return P.stop()}},y)}));return function(r){return W.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(le.Y,{formRef:u,onFinish:ee,modalProps:{destroyOnClose:!0,okButtonProps:{loading:J}},onOpenChange:j,initialValues:i,title:"\u7F16\u8F91\u4FE1\u606F",trigger:m,children:[(0,n.jsx)(se.Z,{layoutType:"Embed",columns:_e}),(0,n.jsx)(ae.Z,{headerTitle:"\u660E\u7EC6\u8868\u683C",rowKey:"id",search:!1,actionRef:B,toolBarRender:function(){return[(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(X.ZP,{danger:!0,disabled:!z||!z.length,onClick:function(){me(z)},children:"\u5220 \u9664"}),(0,n.jsx)(Ge,{orderId:V,id:function(){return(0,ve.V)()},onOk:Re,trigger:(0,n.jsx)(X.ZP,{type:"primary",children:" \u65B0\u5EFA\u660E\u7EC6 "})})]})]},columns:q,request:ce})]})})},qe=t(19632),Ue=t.n(qe),Le=t(4942),We=t(97685),Fe=t(91),xe=t(74165),Ne=t(15861),D=t(1413),He=t(87462),Ye=t(42110),Je=t(32867),ze=function(d,o){return h.createElement(Je.Z,(0,He.Z)({},d,{ref:o,icon:Ye.Z}))},Qe=h.forwardRef(ze),Xe=Qe,er=t(97462),rr=t(952),nr=t(10915),Me=t(48171),tr=t(53914),Ve=t(22270),ar=t(23491),ur=t(53025),lr=t(21770),je=t(88306),ke=t(8880),ir=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],sr=["record","position","creatorButtonText","newRecordType","parentKey","style"],De=h.createContext(void 0);function Ae(e){var d=e.children,o=e.record,E=e.position,u=e.newRecordType,S=e.parentKey,T=(0,h.useContext)(De);return h.cloneElement(d,(0,D.Z)((0,D.Z)({},d.props),{},{onClick:function(){var J=(0,Ne.Z)((0,xe.Z)().mark(function B(ie){var ne,z,Z,A;return(0,xe.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(ne=(z=d.props).onClick)===null||ne===void 0?void 0:ne.call(z,ie);case 2:if(A=l.sent,A!==!1){l.next=5;break}return l.abrupt("return");case 5:T==null||(Z=T.current)===null||Z===void 0||Z.addEditRecord(o,{position:E,newRecordType:u,parentKey:S});case 6:case"end":return l.stop()}},B)}));function H(B){return J.apply(this,arguments)}return H}()}))}function Be(e){var d,o,E=(0,nr.YB)(),u=e.onTableChange,S=e.maxLength,T=e.formItemProps,J=e.recordCreatorProps,H=e.rowKey,B=e.controlled,ie=e.defaultValue,ne=e.onChange,z=e.editableFormRef,Z=(0,Fe.Z)(e,ir),A=(0,h.useRef)(void 0),F=(0,h.useRef)(),l=(0,h.useRef)();(0,h.useImperativeHandle)(Z.actionRef,function(){return F.current},[F.current]);var R=(0,lr.Z)(function(){return e.value||ie||[]},{value:e.value,onChange:e.onChange}),j=(0,We.Z)(R,2),i=j[0],V=j[1],m=h.useMemo(function(){return typeof H=="function"?H:function(f,a){return f[H]||a}},[H]),re=(0,Me.J)(function(f){if(typeof f=="number"&&!e.name){if(f>=i.length)return f;var a=i&&i[f];return m==null?void 0:m(a,f)}if((typeof f=="string"||f>=i.length)&&e.name){var s=i.findIndex(function(v,p){var I;return(m==null||(I=m(v,p))===null||I===void 0?void 0:I.toString())===(f==null?void 0:f.toString())});if(s!==-1)return s}return f});(0,h.useImperativeHandle)(z,function(){var f=function(v){var p,I;if(v==null)throw new Error("rowIndex is required");var N=re(v),x=[e.name,(p=N==null?void 0:N.toString())!==null&&p!==void 0?p:""].flat(1).filter(Boolean);return(I=l.current)===null||I===void 0?void 0:I.getFieldValue(x)},a=function(){var v,p=[e.name].flat(1).filter(Boolean);if(Array.isArray(p)&&p.length===0){var I,N=(I=l.current)===null||I===void 0?void 0:I.getFieldsValue();return Array.isArray(N)?N:Object.keys(N).map(function(x){return N[x]})}return(v=l.current)===null||v===void 0?void 0:v.getFieldValue(p)};return(0,D.Z)((0,D.Z)({},l.current),{},{getRowData:f,getRowsData:a,setRowData:function(v,p){var I,N;if(v==null)throw new Error("rowIndex is required");var x=re(v),L=[e.name,(I=x==null?void 0:x.toString())!==null&&I!==void 0?I:""].flat(1).filter(Boolean),mr=Object.assign({},(0,D.Z)((0,D.Z)({},f(v)),p||{})),fr=(0,ke.Z)({},L,mr);return(N=l.current)===null||N===void 0||N.setFieldsValue(fr),!0}})},[re,e.name,l.current]),(0,h.useEffect)(function(){e.controlled&&(i||[]).forEach(function(f,a){var s;(s=l.current)===null||s===void 0||s.setFieldsValue((0,Le.Z)({},"".concat(m(f,a)),f))},{})},[(0,tr.ZP)(i),e.controlled]),(0,h.useEffect)(function(){if(e.name){var f;l.current=e==null||(f=e.editable)===null||f===void 0?void 0:f.form}},[(d=e.editable)===null||d===void 0?void 0:d.form,e.name]);var ee=J||{},me=ee.record,q=ee.position,Re=ee.creatorButtonText,ce=ee.newRecordType,W=ee.parentKey,y=ee.style,r=(0,Fe.Z)(ee,sr),$=q==="top",U=(0,h.useMemo)(function(){return typeof S=="number"&&S<=(i==null?void 0:i.length)?!1:J!==!1&&(0,n.jsx)(Ae,{record:(0,Ve.h)(me,i==null?void 0:i.length,i)||{},position:q,parentKey:(0,Ve.h)(W,i==null?void 0:i.length,i),newRecordType:ce,children:(0,n.jsx)(X.ZP,(0,D.Z)((0,D.Z)({type:"dashed",style:(0,D.Z)({display:"block",margin:"10px 0",width:"100%"},y),icon:(0,n.jsx)(Xe,{})},r),{},{children:Re||E.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[J,S,i==null?void 0:i.length]),P=(0,h.useMemo)(function(){return U?$?{components:{header:{wrapper:function(a){var s,v=a.className,p=a.children;return(0,n.jsxs)("thead",{className:v,children:[p,(0,n.jsxs)("tr",{style:{position:"relative"},children:[(0,n.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:U}),(0,n.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(s=Z.columns)===null||s===void 0?void 0:s.length,children:U})]})]})}}}}:{tableViewRender:function(a,s){var v,p;return(0,n.jsxs)(n.Fragment,{children:[(v=(p=e.tableViewRender)===null||p===void 0?void 0:p.call(e,a,s))!==null&&v!==void 0?v:s,U]})}}:{}},[$,U]),ue=(0,D.Z)({},e.editable),K=(0,Me.J)(function(f,a){var s,v,p;if((s=e.editable)===null||s===void 0||(v=s.onValuesChange)===null||v===void 0||v.call(s,f,a),(p=e.onValuesChange)===null||p===void 0||p.call(e,a,f),e.controlled){var I;e==null||(I=e.onChange)===null||I===void 0||I.call(e,a)}});return(e!=null&&e.onValuesChange||(o=e.editable)!==null&&o!==void 0&&o.onValuesChange||e.controlled&&e!==null&&e!==void 0&&e.onChange)&&(ue.onValuesChange=K),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(De.Provider,{value:F,children:(0,n.jsx)(ae.Z,(0,D.Z)((0,D.Z)((0,D.Z)({search:!1,options:!1,pagination:!1,rowKey:H,revalidateOnFocus:!1},Z),P),{},{tableLayout:"fixed",actionRef:F,onChange:u,editable:(0,D.Z)((0,D.Z)({},ue),{},{formProps:(0,D.Z)({formRef:l},ue.formProps)}),dataSource:i,onDataSourceChange:function(a){if(V(a),e.name&&q==="top"){var s,v=(0,ke.Z)({},[e.name].flat(1).filter(Boolean),a);(s=l.current)===null||s===void 0||s.setFieldsValue(v)}}}))}),e.name?(0,n.jsx)(er.Z,{name:[e.name],children:function(a){var s,v;if(!A.current)return A.current=i,null;var p=(0,je.Z)(a,[e.name].flat(1)),I=p==null?void 0:p.find(function(N,x){var L;return!(0,ar.A)(N,(L=A.current)===null||L===void 0?void 0:L[x])});return A.current=i,I&&(e==null||(s=e.editable)===null||s===void 0||(v=s.onValuesChange)===null||v===void 0||v.call(s,I,p)),null}}):null]})}function Ke(e){var d=rr.ZP.useFormInstance();return e.name?(0,n.jsx)(ur.Z.Item,(0,D.Z)((0,D.Z)({style:{maxWidth:"100%"}},e==null?void 0:e.formItemProps),{},{name:e.name,shouldUpdate:function(E,u){var S=[e.name].flat(1);try{return JSON.stringify((0,je.Z)(E,S))!==JSON.stringify((0,je.Z)(u,S))}catch(T){return!0}},children:(0,n.jsx)(Be,(0,D.Z)((0,D.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e),{},{editable:(0,D.Z)((0,D.Z)({},e.editable),{},{form:d})}))})):(0,n.jsx)(Be,(0,D.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e))}Ke.RecordCreator=Ae;var or=Ke,dr=function(e){var d,o=(d=h.useRef)===null||d===void 0?void 0:d(),E=function(){var A=b()(_()().mark(function F(){var l,R,j;return _()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!S){V.next=5;break}return V.next=3,g.FO===null||g.FO===void 0?void 0:(0,g.FO)(S);case 3:return j=V.sent,V.abrupt("return",o==null||(l=o.current)===null||l===void 0||(R=l.setFieldsValue)===null||R===void 0?void 0:R.call(l,{id:S,title:"\u91C7\u8D2D\u5165\u5E93\u5355"+(0,ve.V)()}));case 5:case"end":return V.stop()}},F)}));return function(){return A.apply(this,arguments)}}(),u={id:"",title:""},S=e.id,T=e.trigger,J=e.onOk,H=function(){var A=b()(_()().mark(function F(l){var R;return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return l=te()(te()({},l),{},{id:S,item:z}),(R=run)===null||R===void 0||R(l),i.abrupt("return",!0);case 3:case"end":return i.stop()}},F)}));return function(l){return A.apply(this,arguments)}}(),B=function(F){z=Ue()(F)},ie=[{title:"\u7269\u6599\u540D\u79F0",dataIndex:"materialName",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u89C4 \u683C",dataIndex:"materialSku",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u6570 \u91CF",dataIndex:"quantity",sorter:!0,valueType:"digit",tooltip:"\u6B63\u6570",formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u91CF"}]},width:"m",hideInSearch:!0,readonly:!0},{title:"\u5931\u6548\u671F",dataIndex:"exp",sorter:!0,valueType:"date",tooltip:"\u65E5\u671F",formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5931\u6548\u671F"}]},width:"m",hideInSearch:!0},{title:(0,n.jsx)(FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(F,l,R,j){return[(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(X.ZP,{type:"primary",onClick:function(){j.startEditable(l.id)},children:"\u7F16 \u8F91"})})]}}],ne=[{valueType:"group",columns:[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,formItemProps:{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}]},width:"m"}]}],z=[],Z=function(){var A=b()(_()().mark(function F(l){var R;return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,g.ZI===null||g.ZI===void 0?void 0:(0,g.ZI)(S,l,null,null);case 2:return R=i.sent,i.abrupt("return",R);case 4:case"end":return i.stop()}},F)}));return function(l){return A.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(le.Y,{formRef:o,onFinish:H,modalProps:{destroyOnClose:!0,okButtonProps:{loading}},onOpenChange:E,initialValues:u,title:"\u7269\u6599\u5165\u5E93\u5355",trigger:T,children:[(0,n.jsx)(se.Z,{formRef:o,layoutType:"Embed",columns:ne}),(0,n.jsx)(or,{headerTitle:"\u660E\u7EC6\u8868\u683C",rowKey:"id",search:!1,toolBarRender:function(){return[(0,n.jsx)(n.Fragment,{children:" "})]},columns:ie,recordCreatorProps:!1,onChange:B,editable:{type:"multiple",actionRender:function(F,l,R){return[R.save,R.cancel]}},controlled:!0,request:Z})]})})},cr=t(97131),vr=function(){var e,d,o=(0,h.useState)(""),E=Y()(o,2),u=E[0],S=E[1],T=(0,h.useState)(""),J=Y()(T,2),H=J[0],B=J[1],ie=(0,oe.useModel)("@@initialState"),ne=ie.initialState.currentUser,z=ne===void 0?{}:ne,Z=(e=h.useRef)===null||e===void 0?void 0:e(),A=h.useState===null||h.useState===void 0?void 0:(0,h.useState)([]),F=Y()(A,2),l=F[0],R=F[1],j=oe.useIntl===null||oe.useIntl===void 0?void 0:(0,oe.useIntl)(),i=G.ZP===null||G.ZP===void 0||(d=G.ZP.useMessage)===null||d===void 0?void 0:d.call(G.ZP),V=Y()(i,2),m=V[0],re=V[1],ee=[{title:"\u6807 \u9898",dataIndex:"title",sorter:!0,width:"m"},{title:"\u660E\u7EC6\u6570",dataIndex:"itemCount",sorter:!0,hideInForm:!0},{title:"\u72B6 \u6001",dataIndex:"tradeState",sorter:!0,valueType:"select",hideInForm:!0,valueEnum:{edit:{text:"\u5F85\u63D0\u4EA4"},submit:{text:"\u5F85\u5165\u5E93"},stock:{text:"\u5DF2\u91C7\u8D2D\u5B8C\u6210"}}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"create_date",sorter:!0,hideInForm:!0,valueType:"date"},{title:"\u64CD\u4F5C\u8005",dataIndex:"username",sorter:!0,hideInForm:!0},{title:(0,n.jsx)(oe.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(y,r){return[(0,n.jsxs)(n.Fragment,{children:[(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(0,n.jsx)(Ze,{trigger:(0,n.jsx)(X.ZP,{type:"primary",children:"\u7F16 \u8F91"}),id:r==null?void 0:r.id,onOk:ce},r==null?void 0:r.id),(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(r==null?void 0:r.itemCount)>0&&(0,n.jsx)(X.ZP,{type:"primary",onClick:function(){q==null||q(r)},onOk:ce,children:"\u63D0 \u4EA4"}),(r==null?void 0:r.tradeState)==="submit"&&(0,n.jsx)(dr,{id:r==null?void 0:r.id,trigger:(0,n.jsx)(X.ZP,{type:"primary",children:"\u5165 \u5E93"}),onOk:ce}),(!(r!=null&&r.tradeState)||(r==null?void 0:r.tradeState)==="edit")&&(0,n.jsx)(X.ZP,{onClick:function(){me==null||me(r)},danger:!0,onOk:ce,children:"\u5220 \u9664"})]})]}}],me=function(){var W=b()(_()().mark(function y(r){var $;return _()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:O.Z===null||O.Z===void 0||($=O.Z.confirm)===null||$===void 0||$.call(O.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u5220\u9664\u8FD9"+(r==null?void 0:r.length)+"\u9879\u4FE1\u606F?\u5220\u9664\u540E\u5C06\u4E0D\u53EF\u6062\u590D",onOk:function(){b()(_()().mark(function K(){var f,a,s,v,p,I;return _()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,g.IV===null||g.IV===void 0?void 0:(0,g.IV)(r==null||(f=r.map)===null||f===void 0?void 0:f.call(r,function(L){return L==null?void 0:L.id}));case 2:if(a=x.sent,(a==null?void 0:a.code)===0){x.next=7;break}return x.abrupt("return",m==null||(s=m.error)===null||s===void 0?void 0:s.call(m,(a==null?void 0:a.message)||"\u5220\u9664\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5"));case 7:R==null||R([]),Z==null||(v=Z.current)===null||v===void 0||(p=v.reload)===null||p===void 0||p.call(v),m==null||(I=m.success)===null||I===void 0||I.call(m,(a==null?void 0:a.message)||"\u5220\u9664\u64CD\u4F5C\u6210\u529F");case 10:case"end":return x.stop()}},K)}))()}});case 1:case"end":return P.stop()}},y)}));return function(r){return W.apply(this,arguments)}}(),q=function(){var W=b()(_()().mark(function y(r){var $;return _()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:O.Z===null||O.Z===void 0||($=O.Z.confirm)===null||$===void 0||$.call(O.Z,{title:"\u64CD\u4F5C\u63D0\u793A",content:"\u662F\u5426\u786E\u5B9A\u63D0\u4EA4\u6807\u9898\u4E3A".concat(r==null?void 0:r.title,"\u7684\u4FE1\u606F?\u63D0\u4EA4\u540E\u5C06\u4E0D\u53EF\u518D\u6B21\u7F16\u8F91"),onOk:function(){var K;(K=function(){var f=b()(_()().mark(function a(){var s,v,p,I,N;return _()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,g.Ps===null||g.Ps===void 0?void 0:(0,g.Ps)(r==null?void 0:r.id);case 2:if(s=L.sent,(s==null?void 0:s.code)===0){L.next=7;break}return L.abrupt("return",m==null||(v=m.error)===null||v===void 0?void 0:v.call(m,(s==null?void 0:s.message)||"\u63D0\u4EA4\u64CD\u4F5C\u5931\u8D25,\u8BF7\u91CD\u8BD5"));case 7:R==null||R([]),Z==null||(p=Z.current)===null||p===void 0||(I=p.reload)===null||I===void 0||I.call(p),m==null||(N=m.success)===null||N===void 0||N.call(m,(s==null?void 0:s.message)||"\u63D0\u4EA4\u64CD\u4F5C\u6210\u529F");case 10:case"end":return L.stop()}},a)}));return function(){return f.apply(this,arguments)}}())===null||K===void 0||K()}});case 1:case"end":return P.stop()}},y)}));return function(r){return W.apply(this,arguments)}}(),Re=function(){var y;return!!(z!=null&&(y=z.roleIds)!==null&&y!==void 0&&y.includes("1"))},ce=function(){var y;console.log("onOk"),Z==null||(y=Z.current)===null||y===void 0||y.reload(),S==null||S(ve.V===null||ve.V===void 0?void 0:(0,ve.V)())};return h.useEffect===null||h.useEffect===void 0||(0,h.useEffect)(function(){S==null||S(ve.V===null||ve.V===void 0?void 0:(0,ve.V)())},[]),(0,n.jsxs)(cr._z,{children:[re,(0,n.jsx)(ae.Z,{headerTitle:j==null?void 0:j.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u67E5\u8BE2\u8868\u683C"}),actionRef:Z,rowKey:"id",toolBarRender:function(){return[(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(Ze,{trigger:(0,n.jsx)(X.ZP,{type:"primary",disabled:!Re(),children:" \u65B0\u5EFA\u91C7\u8D2D\u5355 "}),id:u,onOk:ce})]})]},request:g.Md,columns:ee,rowSelection:{onChange:function(y,r){R(r)}}})]})}},6493:function(Te,pe,t){t.d(pe,{$G:function(){return Ie},FO:function(){return G},IV:function(){return X},Md:function(){return te},Ps:function(){return be},Vx:function(){return se},ZI:function(){return oe}});var he=t(97857),_=t.n(he),ge=t(15009),b=t.n(ge),ye=t(99289),Y=t.n(ye),M=t(12578);function te(w,k,C){return le.apply(this,arguments)}function le(){return le=Y()(b()().mark(function w(k,C,Q){var c;return b()().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return c="/staff/web/userCenter/purchaseOrder/purchaseOrder/page.json",de.abrupt("return",M.request===null||M.request===void 0?void 0:(0,M.request)(c,{method:"GET",params:{params:k,sort:C,filter:Q}}));case 2:case"end":return de.stop()}},w)})),le.apply(this,arguments)}function se(w){return ae.apply(this,arguments)}function ae(){return ae=Y()(b()().mark(function w(k){var C;return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return C="/staff/web/userCenter/purchaseOrder/purchaseOrder/update.json",c.abrupt("return",M.request===null||M.request===void 0?void 0:(0,M.request)(C,{method:"POST",data:k}));case 2:case"end":return c.stop()}},w)})),ae.apply(this,arguments)}function G(w){return O.apply(this,arguments)}function O(){return O=Y()(b()().mark(function w(k){var C;return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return C="/staff/web/userCenter/purchaseOrder/purchaseOrder/getById.json",c.abrupt("return",M.request===null||M.request===void 0?void 0:(0,M.request)(C,{method:"GET",params:{id:k}}));case 2:case"end":return c.stop()}},w)})),O.apply(this,arguments)}function X(w){return g.apply(this,arguments)}function g(){return g=Y()(b()().mark(function w(k){var C;return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return C="/staff/web/userCenter/purchaseOrder/purchaseOrder/del.json",c.abrupt("return",M.request===null||M.request===void 0?void 0:(0,M.request)(C,{method:"POST",data:_()({},k)}));case 2:case"end":return c.stop()}},w)})),g.apply(this,arguments)}function h(){return _e.apply(this,arguments)}function _e(){return _e=_asyncToGenerator(_regeneratorRuntime().mark(function w(){var k;return _regeneratorRuntime().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return k="/staff/web/userCenter/purchaseOrder/purchaseOrder/page.json",Q.abrupt("return",request==null?void 0:request(k,{method:"GET",params:{pageNum:1,pageSize:0}}));case 2:case"end":return Q.stop()}},w)})),_e.apply(this,arguments)}function oe(w,k,C,Q){return fe.apply(this,arguments)}function fe(){return fe=Y()(b()().mark(function w(k,C,Q,c){var $e;return b()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return $e="/staff/web/userCenter/purchaseOrder/purchaseOrderItem/page.json?orderId="+k,n.abrupt("return",M.request===null||M.request===void 0?void 0:(0,M.request)($e,{method:"GET",params:{params:C,sort:Q,filter:c}}));case 2:case"end":return n.stop()}},w)})),fe.apply(this,arguments)}function Ie(w){return Oe.apply(this,arguments)}function Oe(){return Oe=Y()(b()().mark(function w(k){var C;return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return C="/staff/web/userCenter/purchaseOrder/purchaseOrder/updateItem.json",c.abrupt("return",M.request===null||M.request===void 0?void 0:(0,M.request)(C,{method:"POST",data:k}));case 2:case"end":return c.stop()}},w)})),Oe.apply(this,arguments)}function we(w){return Pe.apply(this,arguments)}function Pe(){return Pe=_asyncToGenerator(_regeneratorRuntime().mark(function w(k){var C;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return C="/staff/web/userCenter/purchaseOrder/purchaseOrder/del.json",c.abrupt("return",request==null?void 0:request(C,{method:"POST",data:_objectSpread({},k)}));case 2:case"end":return c.stop()}},w)})),Pe.apply(this,arguments)}function be(w){return Ce.apply(this,arguments)}function Ce(){return Ce=Y()(b()().mark(function w(k){var C;return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return C="/staff/web/userCenter/purchaseOrder/purchaseOrder/submit.json?id="+k,c.abrupt("return",M.request===null||M.request===void 0?void 0:(0,M.request)(C,{method:"POST"}));case 2:case"end":return c.stop()}},w)})),Ce.apply(this,arguments)}function Se(w){return Ee.apply(this,arguments)}function Ee(){return Ee=_asyncToGenerator(_regeneratorRuntime().mark(function w(k){var C;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return C="/staff/web/userCenter/inventory/inbill/purchaseInstock.json",c.abrupt("return",request==null?void 0:request(C,{method:"POST",data:k}));case 2:case"end":return c.stop()}},w)})),Ee.apply(this,arguments)}},19515:function(Te,pe,t){t.d(pe,{P:function(){return te},V:function(){return M}});var he=t(64599),_=t.n(he),ge=t(19632),b=t.n(ge),ye=t(27484),Y=t.n(ye);function M(){var le=Y()().format("YYYYMMDDHHmmssSSS").toString();return le}function te(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],se=b()(le),ae=_()(se),G;try{for(ae.s();!(G=ae.n()).done;){var O=G.value;!(O!=null&&O.valueType)||(O==null?void 0:O.valueType)!=="group"||!(O!=null&&O.columns)||!(O!=null&&O.columns.length)||se.push.apply(se,b()(O==null?void 0:O.columns))}}catch(X){ae.e(X)}finally{ae.f()}return se.filter(function(X){return X.valueType!=="group"})}}}]);
